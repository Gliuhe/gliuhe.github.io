<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶…çº§å…‘æ¢åˆ¸é“¶è¡Œ - ç†è´¢ä¸­å¿ƒ</title>
    <style>
        /* åŸºç¡€æ ·å¼ - ä¸ä¸»é¡µé¢ä¿æŒä¸€è‡´ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', 'Marker Felt', 'Arial Rounded MT Bold', sans-serif;
        }
        
        :root {
            --primary-color: #06d6a0;
            --secondary-color: #ff6b6b;
            --accent-color: #ffd166;
            --background-gradient: linear-gradient(135deg, #83a4d4 0%, #b6fbff 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-color: #333;
            --border-color: #ffd166;
        }
        
        [data-theme="dark"] {
            --primary-color: #00c896;
            --secondary-color: #ff5252;
            --accent-color: #ffb74d;
            --background-gradient: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            --card-bg: rgba(52, 73, 94, 0.95);
            --text-color: #ecf0f1;
            --border-color: #ffb74d;
        }
        
        [data-theme="pink"] {
            --primary-color: #ff6b9d;
            --secondary-color: #ff9a9e;
            --accent-color: #ffd1dc;
            --background-gradient: linear-gradient(135deg, #ff6b9d 0%, #ff9a9e 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-color: #333;
            --border-color: #ffd1dc;
        }
        
        [data-theme="blue"] {
            --primary-color: #4fc3f7;
            --secondary-color: #29b6f6;
            --accent-color: #81d4fa;
            --background-gradient: linear-gradient(135deg, #1976d2 0%, #42a5f5 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-color: #333;
            --border-color: #81d4fa;
        }

        /* ä¸»é¢˜é€‰æ‹©å™¨æ ·å¼ */
        .theme-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
        }

        .theme-btn {
            padding: 8px 16px;
            border: 2px solid var(--primary-color);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            color: var(--primary-color);
            font-weight: bold;
            font-size: 0.9rem;
        }

        .theme-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .theme-btn.active {
            background: var(--primary-color);
            color: white;
        }
        
        body {
            background: var(--background-gradient);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.5s ease;
        }
        
        .container {
            background: var(--card-bg);
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 1000px;
            padding: 30px;
            margin-top: 20px;
            border: 3px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
            position: relative;
        }
        
        .header h1 {
            color: var(--secondary-color);
            font-size: 2.8rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--secondary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding: 10px 20px;
            border-radius: 50px;
            display: inline-block;
        }
        
        .header::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary-color), var(--accent-color));
            border-radius: 2px;
        }
        
        h2 {
            color: var(--primary-color);
            margin: 20px 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px dashed var(--accent-color);
            font-size: 1.8rem;
        }
        
        /* é“¶è¡Œå¡ç‰‡æ ·å¼ */
        .bank-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 15px 0;
        }
        
        .bank-card {
            width: 100%;
            min-height: 320px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            align-items: start;
        }
        
        .bank-card-main {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .bank-card-history {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            border: 2px solid var(--border-color);
            max-height: 300px;
            overflow-y: auto;
            height: 100%;
            width: 100%;
            min-height: 220px;
        }
        
        .history-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
            text-align: center;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 5px;
        }
        
        .history-item {
            padding: 6px 8px;
            margin-bottom: 6px;
            border-radius: 6px;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 40px;
        }
        
        .history-profit {
            background: rgba(6, 214, 160, 0.2);
            border-left: 4px solid #06d6a0;
        }
        
        .history-loss {
            background: rgba(255, 107, 107, 0.2);
            border-left: 4px solid #ff6b6b;
        }
        
        .history-zero {
            background: rgba(200, 200, 200, 0.2);
            border-left: 4px solid #cccccc;
        }
        
        .history-amount {
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .history-date {
            font-size: 0.75rem;
            color: #666;
        }
        
        .bank-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 18px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            border: 2px solid var(--accent-color);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .bank-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .bank-card::before {
            position: absolute;
            font-size: 4rem;
            opacity: 0.1;
            top: -10px;
            right: -10px;
            transform: rotate(15deg);
            transition: all 0.4s ease;
        }
        
        .bank-card:hover::before {
            transform: rotate(25deg) scale(1.2);
            opacity: 0.2;
        }
        
        .bank-card.savings::before {
            content: "ğŸ’°";
        }
        
        .bank-card.deposit::before {
            content: "ğŸ¦";
        }
        
        .bank-card.investment::before {
            content: "ğŸ“ˆ";
        }
        
        .bank-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
            animation: float 3s ease-in-out infinite;
        }
        
        .bank-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .bank-amount {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--secondary-color);
            margin: 10px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .bank-card:hover .bank-amount {
            transform: scale(1.1);
            color: var(--accent-color);
        }
        
        .bank-info {
            font-size: 1rem;
            color: #666;
            margin: 10px 0;
            line-height: 1.4;
        }
        
        .bank-actions {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .bank-btn {
            padding: 8px 16px;
            font-size: 0.9rem;
            border-radius: 18px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            flex: 1;
            min-width: 100px;
        }
        
        .bank-btn.deposit {
            background: var(--primary-color);
            color: white;
        }
        
        .bank-btn.withdraw {
            background: var(--secondary-color);
            color: white;
        }
        
        .bank-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        

        
        /* äº¤æ˜“å†å²æ ·å¼ */
        .transaction-history {
            margin-top: 30px;
        }
        
        .transaction-item {
            padding: 15px;
            border-bottom: 2px dashed var(--accent-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.5);
        }
        
        .transaction-item:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateX(5px);
        }
        
        .transaction-positive {
            background-color: rgba(6, 214, 160, 0.1);
        }
        
        .transaction-negative {
            background-color: rgba(255, 107, 107, 0.1);
        }
        
        .transaction-interest {
            background-color: rgba(255, 209, 102, 0.1);
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s;
            margin: 8px;
            box-shadow: 0 6px 12px rgba(6, 214, 160, 0.3);
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }
        
        .btn:hover {
            background: #05c191;
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 16px rgba(6, 214, 160, 0.4);
        }
        
        .btn-danger {
            background: #ff6b6b;
            box-shadow: 0 6px 12px rgba(255, 107, 107, 0.3);
        }
        
        .btn-danger:hover {
            background: #ff5252;
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.4);
        }
        
        .form-group {
            margin: 18px 0;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #555;
            font-size: 1.1rem;
        }
        
        input, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 15px;
            font-size: 1.1rem;
            transition: all 0.3s;
            background: #f8f9fa;
        }
        
        input:focus, select:focus {
            border-color: #06d6a0;
            outline: none;
            box-shadow: 0 0 0 3px rgba(6, 214, 160, 0.2);
        }
        
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 25px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
            border: 3px solid #ffd166;
            position: relative;
        }
        
        .status-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 25px;
            font-weight: bold;
            z-index: 1000;
            animation: slideDown 0.5s ease-out;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        .status-success {
            background: #06d6a0;
            color: white;
        }
        
        .status-error {
            background: #ff6b6b;
            color: white;
        }
        
        .status-warning {
            background: #ffd166;
            color: #333;
        }
        
        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes countUp {
            from { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            to { transform: scale(1); opacity: 1; }
        }
        
        .animate-count-up {
            animation: countUp 0.5s ease-out;
        }
        
        /* é“¶è¡Œè®¾ç½®ç‰¹å®šæ ·å¼ */
        .nav-tabs {
            display: flex;
            border-bottom: 3px solid var(--accent-color);
            margin-bottom: 25px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: bold;
            color: #777;
            font-size: 1.2rem;
            position: relative;
            transition: all 0.3s;
            margin: 0 5px;
            border-radius: 15px 15px 0 0;
        }
        
        .nav-tab.active {
            color: var(--primary-color);
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 -5px 10px rgba(0, 0, 0, 0.05);
        }
        
        .nav-tab.active::after {
            content: "";
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary-color);
            border-radius: 2px;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .setting-description {
            background: rgba(255, 255, 255, 0.7);
            border-left: 4px solid var(--primary-color);
            padding: 12px 15px;
            margin-top: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .setting-description strong {
            color: var(--primary-color);
        }
        
        .setting-description ul {
            margin: 8px 0 0 20px;
        }
        
        .setting-description li {
            margin-bottom: 5px;
        }
        
        .risk-display {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 15px 0;
            padding: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            border-radius: 10px;
        }
        
        .rule-section {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid var(--accent-color);
        }
        
        .rule-section h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            border-bottom: 2px dashed var(--accent-color);
            padding-bottom: 8px;
        }
        
        .rule-section ul {
            margin-left: 20px;
        }
        
        .rule-section li {
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
            gap: 15px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* èŒƒå›´æ»‘å—æ ·å¼ */
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .bank-grid {
                gap: 15px;
            }
            
            .bank-card {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            

            
            .bank-actions {
                flex-direction: column;
            }
            
            .bank-btn {
                min-width: auto;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .nav-tab {
                flex: 1;
                text-align: center;
                padding: 12px 8px;
                font-size: 1rem;
                margin: 3px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 90%;
                margin: 8px 0;
            }
            
            .modal-content {
                width: 95%;
                padding: 20px;
            }
            
            .rule-section {
                padding: 15px;
            }
            
            .risk-display {
                font-size: 1rem;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- ä¸»é¢˜é€‰æ‹©å™¨ -->
    <div class="theme-selector">
        <button class="theme-btn active" onclick="setTheme('default')">é»˜è®¤</button>
        <button class="theme-btn" onclick="setTheme('dark')">æš—é»‘</button>
        <button class="theme-btn" onclick="setTheme('pink')">ç²‰è‰²</button>
        <button class="theme-btn" onclick="setTheme('blue')">è“è‰²</button>
    </div>

    <div class="container">
        <div class="header">
            <h1>è¶…çº§å…‘æ¢åˆ¸é“¶è¡Œ</h1>
            <p>è®©æ‚¨çš„å…‘æ¢åˆ¸å¢å€¼ï¼å®‰å…¨ç†è´¢ï¼Œè·å–åˆ©æ¯</p>
        </div>

        <!-- è¿”å›ä¸»é¡µæŒ‰é’® -->
        <div style="text-align: center; margin-bottom: 25px;">
            <button class="btn" onclick="goBack()">ğŸ  è¿”å›ä¸»é¡µé¢</button>
            <button class="btn" onclick="openSettingsModal()" style="background: var(--accent-color); color: #333;">âš™ï¸ é“¶è¡Œè®¾ç½®</button>
            <button class="btn" onclick="simulateNextDay()" style="background: var(--secondary-color); color: white;">ğŸš€ è¶…çº§å¿«è¿›</button>
        </div>

        <!-- å½“å‰å…‘æ¢åˆ¸ä½™é¢ -->
        <div class="bank-card savings">
            <div class="bank-icon">ğŸ«</div>
            <div class="bank-title">å½“å‰å…‘æ¢åˆ¸ä½™é¢</div>
            <div class="bank-amount" id="currentVoucherAmount">0</div>
            <div class="bank-info">è¿™æ˜¯æ‚¨å¯ä»¥ç”¨äºå­˜å‚¨å’Œæ¶ˆè´¹çš„å…‘æ¢åˆ¸æ•°é‡</div>
        </div>

        <!-- é“¶è¡Œè´¦æˆ·æ€»è§ˆ -->
        <h2>æˆ‘çš„é“¶è¡Œè´¦æˆ·</h2>
        <div class="bank-grid">
            <!-- æ´»æœŸå­˜æ¬¾ -->
            <div class="bank-card savings">
                <div class="bank-card-main">
                    <div class="bank-icon">ğŸ’°</div>
                    <div class="bank-title">æ´»æœŸå­˜æ¬¾</div>
                    <div class="bank-amount" id="savingsAmount">0</div>
                    <div class="bank-earnings" style="margin: 10px 0; padding: 8px; background: rgba(6, 214, 160, 0.1); border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9rem; color: #666;">æ˜¨æ—¥æ”¶ç›Š</div>
                        <div class="yesterday-earnings" id="savingsEarnings" style="font-size: 1.4rem; font-weight: bold; color: #ff6b6b;">0</div>
                    </div>
                    <div class="bank-info">
                        <div>æ—¥åˆ©ç‡: <span id="savingsRateDisplay">0.1%</span></div>
                        <div>éšæ—¶å­˜å–ï¼Œçµæ´»æ–¹ä¾¿</div>
                    </div>
                    <div class="bank-actions">
                        <button class="bank-btn deposit" onclick="openDepositModal('savings')">å­˜å…¥</button>
                        <button class="bank-btn withdraw" onclick="openWithdrawModal('savings')">å–å‡º</button>
                    </div>
                </div>
                <div class="bank-card-history">
                    <div class="history-title">ğŸ“Š æ”¶ç›Šè®°å½•</div>
                    <div id="savingsHistory"></div>
                </div>
            </div>

            <!-- å®šæœŸå­˜æ¬¾ -->
            <div class="bank-card deposit">
                <div class="bank-card-main">
                    <div class="bank-icon">ğŸ¦</div>
                    <div class="bank-title">å®šæœŸå­˜æ¬¾</div>
                    <div class="bank-amount" id="depositAmount">0</div>
                    <div class="bank-earnings" style="margin: 10px 0; padding: 8px; background: rgba(6, 214, 160, 0.1); border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9rem; color: #666;">æ˜¨æ—¥æ”¶ç›Š</div>
                        <div class="yesterday-earnings" id="depositEarnings" style="font-size: 1.4rem; font-weight: bold; color: #ff6b6b;">0</div>
                    </div>
                    <div class="bank-info" id="depositInfo">
                        <div>æ—¥åˆ©ç‡: <span id="depositRateDisplay">0.3%</span></div>
                        <div>7å¤©æœŸé™ï¼Œæ”¶ç›Šæ›´é«˜</div>
                    </div>
                    <div class="bank-actions">
                        <button class="bank-btn deposit" onclick="openDepositModal('deposit')">å­˜å…¥</button>
                        <button class="bank-btn withdraw" onclick="openWithdrawModal('deposit')">å–å‡º</button>
                    </div>
                </div>
                <div class="bank-card-history">
                    <div class="history-title">ğŸ“Š æ”¶ç›Šè®°å½•</div>
                    <div id="depositHistory"></div>
                </div>
            </div>

            <!-- æŠ•èµ„ç†è´¢ -->
            <div class="bank-card investment">
                <div class="bank-card-main">
                    <div class="bank-icon">ğŸ“ˆ</div>
                    <div class="bank-title">æŠ•èµ„ç†è´¢</div>
                    <div class="bank-amount" id="investmentAmount">0</div>
                    <div class="bank-earnings" style="margin: 10px 0; padding: 8px; background: rgba(255, 107, 107, 0.1); border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9rem; color: #666;">æ˜¨æ—¥æ”¶ç›Š</div>
                        <div class="yesterday-earnings" id="investmentEarnings" style="font-size: 1.4rem; font-weight: bold; color: #ff6b6b;">0</div>
                    </div>
                    <div class="bank-info" id="investmentInfo">
                        <div>æ—¥æ”¶ç›Š: <span id="investmentRateDisplay">æ³¢åŠ¨æ”¶ç›Š</span></div>
                        <div>å½“æ—¥å­˜å…¥æ¬¡æ—¥å¯å–ï¼Œçº¯é æ³¢åŠ¨</div>
                    </div>
                    <div class="bank-actions">
                        <button class="bank-btn deposit" onclick="openDepositModal('investment')">æŠ•èµ„</button>
                        <button class="bank-btn withdraw" onclick="openWithdrawModal('investment')">èµå›</button>
                    </div>
                </div>
                <div class="bank-card-history">
                    <div class="history-title">ğŸ“Š ç›ˆåˆ©/äºæŸè®°å½•</div>
                    <div id="investmentHistory"></div>
                </div>
            </div>
        </div>



        <!-- äº¤æ˜“å†å² -->
        <h2>äº¤æ˜“å†å²</h2>
        <div class="transaction-history">
            <div id="transactionList"></div>
        </div>
    </div>

    <!-- å­˜å…¥æ¨¡æ€æ¡† -->
    <div id="depositModal" class="modal">
        <div class="modal-content">
            <h2 id="depositModalTitle">å­˜å…¥èµ„é‡‘</h2>
            <input type="hidden" id="depositAccountType" value="">
            <div class="form-group">
                <label for="depositInputAmount">å­˜å…¥æ•°é‡</label>
                <input type="number" id="depositInputAmount" min="1" placeholder="è¯·è¾“å…¥å­˜å…¥æ•°é‡">
            </div>
            
            <button class="btn" onclick="processDeposit()">ç¡®è®¤å­˜å…¥</button>
            <button class="btn btn-danger" onclick="closeDepositModal()">å–æ¶ˆ</button>
        </div>
    </div>

    <!-- å–å‡ºæ¨¡æ€æ¡† -->
    <div id="withdrawModal" class="modal">
        <div class="modal-content">
            <h2 id="withdrawModalTitle">å–å‡ºèµ„é‡‘</h2>
            <input type="hidden" id="withdrawAccountType" value="">
            <div class="form-group">
                <label for="withdrawAmount">å–å‡ºæ•°é‡</label>
                <input type="number" id="withdrawAmount" min="1" placeholder="è¯·è¾“å…¥å–å‡ºæ•°é‡">
            </div>
            
            <button class="btn" onclick="processWithdraw()">ç¡®è®¤å–å‡º</button>
            <button class="btn btn-danger" onclick="closeWithdrawModal()">å–æ¶ˆ</button>
        </div>
    </div>

    <!-- å¯†ç éªŒè¯æ¨¡æ€æ¡† -->
    <div id="passwordVerifyModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <h2>ğŸ”’ å¯†ç éªŒè¯</h2>
            <p>è¯·è¾“å…¥å¯†ç è¿›å…¥é“¶è¡Œè®¾ç½®</p>
            <div class="form-group">
                <label for="verifyPassword">å¯†ç </label>
                <input type="password" id="verifyPassword" placeholder="è¯·è¾“å…¥å¯†ç ">
            </div>
            <div class="modal-actions">
                <button class="btn" onclick="verifyBankPassword()">ç¡®è®¤</button>
                <button class="btn btn-danger" onclick="closePasswordVerifyModal()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- è¶…çº§å¿«è¿›æ¨¡æ€æ¡† -->
    <div id="simulateNextDayModal" class="modal">
        <div class="modal-content" style="max-width: 500px; max-height: 70vh; overflow-y: auto;">
            <h2>ğŸš€ è¶…çº§å¿«è¿›</h2>
            <div id="simulateNextDayContent">
                <p>æ­£åœ¨æ£€æŸ¥è´§å¸æ•°é‡...</p>
            </div>
            <div class="modal-actions" style="margin-top: 20px;">
                <button class="btn" id="confirmSimulateBtn" style="display: none;">ç¡®è®¤å¿«è¿›</button>
                <button class="btn btn-danger" onclick="closeSimulateNextDayModal()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- é“¶è¡Œè®¾ç½®æ¨¡æ€æ¡† -->
    <div id="settingsModal" class="modal">
        <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
            <h2>âš™ï¸ é“¶è¡Œç³»ç»Ÿè®¾ç½®</h2>
            
            <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
            <div class="nav-tabs">
                <div class="nav-tab active" onclick="switchSettingsTab('rates')">ğŸ’° åˆ©ç‡è®¾ç½®</div>
                <div class="nav-tab" onclick="switchSettingsTab('risk')">ğŸ“Š é£é™©é…ç½®</div>
                <div class="nav-tab" onclick="switchSettingsTab('records')">ğŸ“‹ è®°å½•ç®¡ç†</div>
                <div class="nav-tab" onclick="switchSettingsTab('rules')">ğŸ“ è§„åˆ™è¯´æ˜</div>
            </div>
            
            <!-- åˆ©ç‡è®¾ç½®æ ‡ç­¾é¡µ -->
            <div id="rates" class="tab-content active">
                <h3>è´¦æˆ·åˆ©ç‡é…ç½®</h3>
                <div class="form-group">
                    <label for="savingsRate">æ´»æœŸå­˜æ¬¾åˆ©ç‡ (%)</label>
                    <input type="number" id="savingsRate" min="0" max="100" step="0.01" placeholder="è¯·è¾“å…¥æ´»æœŸå­˜æ¬¾åˆ©ç‡">
                    <div class="setting-description">
                        <strong>è§„åˆ™è¯´æ˜ï¼š</strong>æ´»æœŸå­˜æ¬¾æ¯æ—¥è®¡ç®—åˆ©æ¯ï¼Œéšæ—¶å­˜å–ï¼Œé€‚åˆçŸ­æœŸèµ„é‡‘ç®¡ç†
                    </div>
                </div>
                <div class="form-group">
                    <label for="depositRate">å®šæœŸå­˜æ¬¾åˆ©ç‡ (%)</label>
                    <input type="number" id="depositRate" min="0" max="100" step="0.01" placeholder="è¯·è¾“å…¥å®šæœŸå­˜æ¬¾åˆ©ç‡">
                    <div class="setting-description">
                        <strong>è§„åˆ™è¯´æ˜ï¼š</strong>å®šæœŸå­˜æ¬¾7å¤©æœŸé™ï¼ŒæœŸé—´ä¸å¯å–å‡ºï¼Œåˆ°æœŸè‡ªåŠ¨ç»­å­˜
                    </div>
                </div>
                <div class="form-group">
                    <label for="investmentRate">æŠ•èµ„ç†è´¢åŸºç¡€æ”¶ç›Šç‡ (%)</label>
                    <input type="number" id="investmentRate" min="0" max="100" step="0.01" placeholder="è¯·è¾“å…¥åŸºç¡€æ”¶ç›Šç‡" disabled>
                    <div class="setting-description">
                        <strong>è§„åˆ™è¯´æ˜ï¼š</strong>æŠ•èµ„ç†è´¢åŸºç¡€æ”¶ç›Šç‡ä¸º0%ï¼Œçº¯é æ¯æ—¥æ³¢åŠ¨ï¼Œå½“æ—¥å­˜å…¥æ¬¡æ—¥å¯å–
                    </div>
                </div>
            </div>
            
            <!-- é£é™©é…ç½®æ ‡ç­¾é¡µ -->
            <div id="risk" class="tab-content">
                <h3>é£é™©æ³¢åŠ¨é…ç½®</h3>
                
                <div class="form-group">
                    <label for="riskMinLoss">æœ€å¤§äºæŸæ¯”ä¾‹ (%)</label>
                    <input type="number" id="riskMinLoss" min="-100" max="0" step="1" value="-18" placeholder="è¯·è¾“å…¥æœ€å¤§äºæŸæ¯”ä¾‹">
                    <div class="setting-description">
                        <strong>è¯´æ˜ï¼š</strong>æŠ•èµ„ç†è´¢è´¦æˆ·å¯èƒ½å‡ºç°çš„æœ€å¤§äºæŸæ¯”ä¾‹ï¼Œè´Ÿå€¼è¡¨ç¤ºäºæŸ
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="riskMaxProfit">æœ€å¤§ç›ˆåˆ©æ¯”ä¾‹ (%)</label>
                    <input type="number" id="riskMaxProfit" min="0" max="100" step="1" value="25" placeholder="è¯·è¾“å…¥æœ€å¤§ç›ˆåˆ©æ¯”ä¾‹">
                    <div class="setting-description">
                        <strong>è¯´æ˜ï¼š</strong>æŠ•èµ„ç†è´¢è´¦æˆ·å¯èƒ½å‡ºç°çš„æœ€å¤§ç›ˆåˆ©æ¯”ä¾‹
                    </div>
                </div>
                
                <div class="form-group">
                    <label>æ³¢åŠ¨æ¦‚ç‡åˆ†å¸ƒ</label>
                    <div style="background: rgba(255, 255, 255, 0.7); padding: 15px; border-radius: 10px; margin-top: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span style="color: #ff6b6b;">ğŸ“‰ äºæŸæ¦‚ç‡: 38%</span>
                            <span style="color: #06d6a0;">ğŸ“ˆ ç›ˆåˆ©æ¦‚ç‡: 57%</span>
                            <span style="color: #666;">ğŸ“Š é›¶æ”¶ç›Šæ¦‚ç‡: 5%</span>
                        </div>
                        <div style="background: #f0f0f0; height: 20px; border-radius: 10px; overflow: hidden;">
                            <div style="background: #ff6b6b; width: 38%; height: 100%; float: left;"></div>
                            <div style="background: #06d6a0; width: 57%; height: 100%; float: left;"></div>
                            <div style="background: #666; width: 5%; height: 100%; float: left;"></div>
                        </div>
                    </div>
                    <div class="setting-description">
                        <strong>æ¦‚ç‡è¯´æ˜ï¼š</strong>æŠ•èµ„ç†è´¢è´¦æˆ·æ¯æ—¥æ”¶ç›Šçš„æ³¢åŠ¨æ¦‚ç‡åˆ†å¸ƒ
                    </div>
                </div>
                
                <div class="form-group">
                    <label>å½“å‰é…ç½®é¢„è§ˆ</label>
                    <div class="risk-display" style="text-align: center; font-size: 1.1rem;">
                        <div>æŠ•èµ„ç†è´¢æ³¢åŠ¨èŒƒå›´: <span id="currentRiskRange">-18% ~ +25%</span></div>
                        <div style="font-size: 0.9rem; margin-top: 5px;">ä»…å¯¹æŠ•èµ„ç†è´¢è´¦æˆ·ç”Ÿæ•ˆ</div>
                    </div>
                </div>
            </div>
            
            <!-- è®°å½•ç®¡ç†æ ‡ç­¾é¡µ -->
            <div id="records" class="tab-content">
                <h3>ğŸ“‹ è®°å½•ç®¡ç†</h3>
                
                <div class="form-group">
                    <label>æ”¶ç›Šè®°å½•ç®¡ç†</label>
                    <div style="background: rgba(255, 255, 255, 0.7); padding: 15px; border-radius: 10px; margin-top: 10px;">
                        <div style="text-align: center; margin-bottom: 15px;">
                            <h4 style="color: #ff6b6b; margin: 0;">âš ï¸ å±é™©æ“ä½œ</h4>
                            <p style="font-size: 0.9rem; color: #666;">æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤æ‰€æœ‰æ”¶ç›Šè®°å½•ï¼Œæ— æ³•æ¢å¤ï¼</p>
                        </div>
                        
                        <div style="display: flex; justify-content: center; gap: 15px;">
                            <button class="btn btn-danger" onclick="clearEarningsRecords()" style="background: #ff6b6b; color: white; padding: 10px 20px;">
                                ğŸ—‘ï¸ æ¸…ç©ºæ”¶ç›Šè®°å½•
                            </button>
                        </div>
                        
                        <div style="margin-top: 15px; padding: 10px; background: rgba(255, 107, 107, 0.1); border-radius: 5px;">
                            <p style="font-size: 0.85rem; color: #ff6b6b; margin: 0;">
                                <strong>æ³¨æ„ï¼š</strong>æ¸…ç©ºåæ‰€æœ‰å†å²æ”¶ç›Šè®°å½•å°†è¢«æ°¸ä¹…åˆ é™¤ï¼ŒåŒ…æ‹¬åˆ©æ¯æ”¶ç›Šã€æŠ•èµ„ç›ˆäºç­‰æ‰€æœ‰è®°å½•ã€‚
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>å½“å‰è®°å½•ç»Ÿè®¡</label>
                    <div style="background: rgba(255, 255, 255, 0.7); padding: 15px; border-radius: 10px; margin-top: 10px;">
                        <div id="recordsStats" style="text-align: center;">
                            <div>ğŸ“Š æ­£åœ¨åŠ è½½è®°å½•ç»Ÿè®¡...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- è®°å½•ç®¡ç†æ ‡ç­¾é¡µ -->
            <div id="records" class="tab-content">
                <h3>ğŸ“‹ è®°å½•ç®¡ç†</h3>
                
                <div class="form-group">
                    <label>æ”¶ç›Šè®°å½•ç®¡ç†</label>
                    <div style="background: rgba(255, 255, 255, 0.7); padding: 15px; border-radius: 10px; margin-top: 10px;">
                        <div style="text-align: center; margin-bottom: 15px;">
                            <h4 style="color: #ff6b6b; margin: 0;">âš ï¸ å±é™©æ“ä½œ</h4>
                            <p style="font-size: 0.9rem; color: #666;">æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤æ‰€æœ‰æ”¶ç›Šè®°å½•ï¼Œæ— æ³•æ¢å¤ï¼</p>
                        </div>
                        
                        <div style="display: flex; justify-content: center; gap: 15px;">
                            <button class="btn btn-danger" onclick="clearEarningsRecords()" style="background: #ff6b6b; color: white; padding: 10px 20px;">
                                ğŸ—‘ï¸ æ¸…ç©ºæ”¶ç›Šè®°å½•
                            </button>
                        </div>
                        
                        <div style="margin-top: 15px; padding: 10px; background: rgba(255, 107, 107, 0.1); border-radius: 5px;">
                            <p style="font-size: 0.85rem; color: #ff6b6b; margin: 0;">
                                <strong>æ³¨æ„ï¼š</strong>æ¸…ç©ºåæ‰€æœ‰å†å²æ”¶ç›Šè®°å½•å°†è¢«æ°¸ä¹…åˆ é™¤ï¼ŒåŒ…æ‹¬åˆ©æ¯æ”¶ç›Šã€æŠ•èµ„ç›ˆäºç­‰æ‰€æœ‰è®°å½•ã€‚
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>å½“å‰è®°å½•ç»Ÿè®¡</label>
                    <div style="background: rgba(255, 255, 255, 0.7); padding: 15px; border-radius: 10px; margin-top: 10px;">
                        <div id="recordsStats" style="text-align: center;">
                            <div>ğŸ“Š æ­£åœ¨åŠ è½½è®°å½•ç»Ÿè®¡...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- è§„åˆ™è¯´æ˜æ ‡ç­¾é¡µ -->
            <div id="rules" class="tab-content">
                <h3>é“¶è¡Œç³»ç»Ÿè§„åˆ™è¯´æ˜</h3>
                
                <div class="rule-section">
                    <h4>ğŸ“ˆ åˆ©æ¯è®¡ç®—è§„åˆ™</h4>
                    <ul>
                        <li><strong>æ¯æ—¥è®¡æ¯ï¼š</strong>æ‰€æœ‰è´¦æˆ·ç±»å‹æ¯æ—¥å‡Œæ™¨è‡ªåŠ¨è®¡ç®—åˆ©æ¯</li>
                        <li><strong>å¤åˆ©è®¡ç®—ï¼š</strong>åˆ©æ¯è‡ªåŠ¨åŠ å…¥æœ¬é‡‘ï¼Œæ¬¡æ—¥ç»§ç»­è®¡ç®—åˆ©æ¯</li>
                        <li><strong>æ—¶é—´è§„åˆ™ï¼š</strong>å®šæœŸå’ŒæŠ•èµ„è´¦æˆ·æŒ‰å®Œæ•´å‘¨æœŸè®¡ç®—</li>
                    </ul>
                </div>
                
                <div class="rule-section">
                    <h4>âš¡ å­˜å–æ¬¾è§„åˆ™</h4>
                    <ul>
                        <li><strong>æ´»æœŸå­˜æ¬¾ï¼š</strong>éšæ—¶å­˜å–ï¼Œæ— é™åˆ¶æ¡ä»¶</li>
                        <li><strong>å®šæœŸå­˜æ¬¾ï¼š</strong>7å¤©æœŸé™ï¼ŒæœŸé—´ä¸å¯å–å‡ºï¼Œåˆ°æœŸè‡ªåŠ¨ç»­å­˜</li>
                        <li><strong>æŠ•èµ„ç†è´¢ï¼š</strong>åŸºç¡€æ”¶ç›Šç‡ä¸º0%ï¼Œçº¯é æ¯æ—¥æ³¢åŠ¨ï¼Œå½“æ—¥å­˜å…¥æ¬¡æ—¥å¯å–</li>
                    </ul>
                </div>
                
                <div class="rule-section">
                    <h4>ğŸ“Š é£é™©æœºåˆ¶</h4>
                    <ul>
                        <li><strong>é£é™©æ³¢åŠ¨ï¼š</strong>ä»…å¯¹æŠ•èµ„ç†è´¢è´¦æˆ·ç”Ÿæ•ˆï¼Œæ´»æœŸå’Œå®šæœŸå­˜æ¬¾æ— é£é™©æ³¢åŠ¨</li>
                        <li><strong>æ³¢åŠ¨èŒƒå›´ï¼š</strong>æ¯æ—¥æ”¶ç›Šåœ¨-18%~+25%ä¹‹é—´éšæœºæ³¢åŠ¨</li>
                        <li><strong>æ¦‚ç‡åˆ†å¸ƒï¼š</strong>30%æ¦‚ç‡äºæŸï¼Œ65%æ¦‚ç‡ç›ˆåˆ©ï¼Œ5%æ¦‚ç‡é›¶æ”¶ç›Š</li>
                        <li><strong>å®‰å…¨ä¿éšœï¼š</strong>æœ¬é‡‘ä¸ä¼šå› é£é™©æ³¢åŠ¨è€Œå‡å°‘</li>
                    </ul>
                </div>
                
                <div class="rule-section">
                    <h4>ğŸ’¡ ä½¿ç”¨å»ºè®®</h4>
                    <ul>
                        <li>æ ¹æ®èµ„é‡‘ä½¿ç”¨è®¡åˆ’é€‰æ‹©åˆé€‚çš„è´¦æˆ·ç±»å‹</li>
                        <li>é£é™©æ‰¿å—èƒ½åŠ›è¾ƒä½å»ºè®®é€‰æ‹©ä¿å®ˆå‹é…ç½®</li>
                        <li>å®šæœŸæ£€æŸ¥è´¦æˆ·ä½™é¢å’Œåˆ©æ¯æ”¶ç›Š</li>
                    </ul>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn" onclick="saveSettings()">ğŸ’¾ ä¿å­˜è®¾ç½®</button>
                <button class="btn btn-warning" onclick="resetToDefault()">ğŸ”„ æ¢å¤é»˜è®¤</button>
                <button class="btn btn-danger" onclick="closeSettingsModal()">âŒ å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        // è¯Šæ–­ä»£ç  - å…¨å±€é”™è¯¯æ•è·
        window.addEventListener('error', function(e) {
            console.error("[å…¨å±€é”™è¯¯] ", e.message, "å‘ç”Ÿåœ¨", e.filename, "è¡Œå·:", e.lineno);
        });

        // é“¶è¡Œé…ç½®
        let BANK_CONFIG = {
            savings: { name: 'æ´»æœŸå­˜æ¬¾', rate: parseFloat(localStorage.getItem('bankSavingsRate') || '0.001'), key: 'bankSavings', period: 0, hasFluctuation: false },
            deposit: { name: 'å®šæœŸå­˜æ¬¾', rate: parseFloat(localStorage.getItem('bankDepositRate') || '0.003'), key: 'bankDeposit', period: 7, hasFluctuation: false }, // æ”¹å›7å¤©æœŸé™
            investment: { name: 'æŠ•èµ„ç†è´¢', rate: 0, key: 'bankInvestment', period: 1, hasFluctuation: true } // æŠ•èµ„ç†è´¢åŸºç¡€æ”¶ç›Šç‡ä¸º0%ï¼Œçº¯é æ³¢åŠ¨
        };

        // é£é™©æ³¢åŠ¨é…ç½®
        let RISK_CONFIG = {
            minLoss: parseFloat(localStorage.getItem('riskMinLoss') || '-0.18'),  // æœ€å°äºæŸæ¯”ä¾‹
            maxProfit: parseFloat(localStorage.getItem('riskMaxProfit') || '0.25'), // æœ€å¤§ç›ˆåˆ©æ¯”ä¾‹
            lossProbability: 0.38,  // äºæŸæ¦‚ç‡ 38%
            profitProbability: 0.57, // ç›ˆåˆ©æ¦‚ç‡ 57%
            zeroProbability: 0.05    // é›¶æ”¶ç›Šæ¦‚ç‡ 5%
        };

        // æ›´æ–°åˆ©ç‡æ˜¾ç¤º
        function updateRateDisplays() {
            Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                const rateDisplay = document.getElementById(`${type}RateDisplay`);
                if (rateDisplay) {
                    rateDisplay.textContent = `${(config.rate * 100).toFixed(1)}%`;
                }
            });
        }

        // é“¶è¡Œè´¦æˆ·æ˜¨æ—¥æ”¶ç›ŠåŠŸèƒ½
        function updateBankEarnings() {
            // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†è¶…çº§å¿«è¿›åŠŸèƒ½
            const superFastForwardUsed = localStorage.getItem('superFastForwardUsed');
            if (superFastForwardUsed === 'true') {
                console.log("[åˆ©æ¯è®¡ç®—] æ£€æµ‹åˆ°è¶…çº§å¿«è¿›å·²ä½¿ç”¨ï¼Œè·³è¿‡åˆ©æ¯è®¡ç®—");
                // æ¸…é™¤è¶…çº§å¿«è¿›æ ‡è®°ï¼Œä»¥ä¾¿ä¸‹æ¬¡æ­£å¸¸è®¡ç®—
                localStorage.removeItem('superFastForwardUsed');
                
                // æ˜¾ç¤ºæ˜¨æ—¥æ”¶ç›Šï¼ˆä½†ä¸è®¡ç®—æ–°çš„åˆ©æ¯ï¼‰
                Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                    const earningsElement = document.getElementById(`${type}Earnings`);
                    if (earningsElement) {
                        const yesterdayEarnings = parseInt(localStorage.getItem(`yesterdayEarnings_${type}`) || '0');
                        const yesterdayRate = parseFloat(localStorage.getItem(`yesterdayRate_${type}`) || config.rate);
                        
                        // æ˜¾ç¤ºæ”¶ç›Šå’Œå®é™…åˆ©ç‡
                        if (config.hasFluctuation) {
                            const baseRatePercent = (config.rate * 100).toFixed(1);
                            const actualRatePercent = (yesterdayRate * 100).toFixed(1);
                            
                            // é¿å…é™¤ä»¥é›¶é”™è¯¯
                            let fluctuation = '0.0';
                            if (config.rate !== 0) {
                                fluctuation = ((yesterdayRate - config.rate) / config.rate * 100).toFixed(1);
                            }
                            
                            const fluctuationSign = fluctuation >= 0 ? '+' : '';
                            
                            earningsElement.innerHTML = `${yesterdayEarnings}<br><span style="font-size: 0.8rem; color: ${yesterdayRate >= 0 ? '#06d6a0' : '#ff6b6b'}">${actualRatePercent}% (${fluctuationSign}${fluctuation}%)</span>`;
                        } else {
                            earningsElement.textContent = yesterdayEarnings;
                        }
                        
                        // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                        if (yesterdayEarnings > 0) {
                            earningsElement.classList.add('animate-count-up');
                            setTimeout(() => earningsElement.classList.remove('animate-count-up'), 500);
                        }
                    }
                });
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°æ˜¨æ—¥æ”¶ç›Š
            const today = new Date().toDateString();
            const lastVisitDate = localStorage.getItem('lastVisitDate');
            
            // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®æˆ–æ–°çš„ä¸€å¤©ï¼Œè®¡ç®—æ˜¨æ—¥æ”¶ç›Š
            if (!lastVisitDate || lastVisitDate !== today) {
                console.log("[åˆ©æ¯è®¡ç®—] æ£€æµ‹åˆ°æ–°çš„ä¸€å¤©ï¼Œå¼€å§‹è®¡ç®—åˆ©æ¯");
                
                // è®¡ç®—æ˜¨æ—¥æ”¶ç›Šï¼ˆè€ƒè™‘æ³¢åŠ¨ï¼‰
                Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                    const amount = parseInt(localStorage.getItem(config.key) || '0');
                    if (amount > 0) {
                        console.log(`[åˆ©æ¯è®¡ç®—] è®¡ç®— ${config.name} åˆ©æ¯ï¼Œé‡‘é¢: ${amount}`);
                        
                        // è®¡ç®—å®é™…åˆ©ç‡ï¼ˆè€ƒè™‘æ³¢åŠ¨ï¼‰
                        let actualRate = config.rate;
                        let fluctuationType = 'none';
                        
                        if (config.hasFluctuation) {
                            // ä½¿ç”¨ä¼˜åŒ–çš„æ³¢åŠ¨ç®—æ³•ï¼Œç¡®ä¿æ¦‚ç‡åˆ†å¸ƒå‡†ç¡®
                            const random = Math.random();
                            
                            if (random < RISK_CONFIG.lossProbability) {
                                // 38%æ¦‚ç‡äºæŸï¼š-18%åˆ°0%
                                fluctuationType = 'loss';
                                actualRate = RISK_CONFIG.minLoss * Math.random(); // å‡åŒ€åˆ†å¸ƒåœ¨æœ€å°äºæŸåˆ°0ä¹‹é—´
                                console.log(`[åˆ©æ¯è®¡ç®—] ${config.name} äºæŸæ³¢åŠ¨ï¼Œå®é™…åˆ©ç‡: ${(actualRate * 100).toFixed(2)}%`);
                            } else if (random < RISK_CONFIG.lossProbability + RISK_CONFIG.profitProbability) {
                                // 57%æ¦‚ç‡ç›ˆåˆ©ï¼š0%åˆ°25%
                                fluctuationType = 'profit';
                                actualRate = RISK_CONFIG.maxProfit * Math.random(); // å‡åŒ€åˆ†å¸ƒåœ¨0åˆ°æœ€å¤§ç›ˆåˆ©ä¹‹é—´
                                console.log(`[åˆ©æ¯è®¡ç®—] ${config.name} ç›ˆåˆ©æ³¢åŠ¨ï¼Œå®é™…åˆ©ç‡: ${(actualRate * 100).toFixed(2)}%`);
                            } else {
                                // 5%æ¦‚ç‡é›¶æ”¶ç›Š
                                fluctuationType = 'zero';
                                actualRate = 0;
                                console.log(`[åˆ©æ¯è®¡ç®—] ${config.name} é›¶æ”¶ç›Š`);
                            }
                        }
                        
                        const interest = Math.floor(amount * actualRate);
                        console.log(`[åˆ©æ¯è®¡ç®—] ${config.name} è®¡ç®—åˆ©æ¯: ${interest} (åˆ©ç‡: ${(actualRate * 100).toFixed(2)}%)`);
                        
                        if (interest !== 0) {
                            // æ·»åŠ åˆ©æ¯åˆ°è´¦æˆ·ï¼ˆåªæœ‰éé›¶æ”¶ç›Šæ‰è®°å½•ï¼‰
                            localStorage.setItem(config.key, (amount + interest).toString());
                            
                            // ä¿å­˜æ˜¨æ—¥æ”¶ç›Šå’Œå®é™…åˆ©ç‡ç”¨äºæ˜¾ç¤º
                            localStorage.setItem(`yesterdayEarnings_${type}`, interest.toString());
                            localStorage.setItem(`yesterdayRate_${type}`, actualRate.toString());
                            
                            // è®°å½•åˆ©æ¯äº¤æ˜“åˆ°äº¤æ˜“å†å²
                            const transaction = {
                                type: 'interest',
                                accountType: type,
                                accountName: config.name,
                                amount: interest,
                                date: new Date().toISOString(),
                                fluctuationType: fluctuationType
                            };
                            
                            const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
                            transactions.push(transaction);
                            localStorage.setItem('bankTransactions', JSON.stringify(transactions));
                            
                            console.log(`[åˆ©æ¯è®¡ç®—] ${config.name} åˆ©æ¯å·²æ›´æ–°ï¼Œæ–°ä½™é¢: ${amount + interest}`);
                        } else if (config.hasFluctuation && fluctuationType === 'zero') {
                            // é›¶æ”¶ç›Šæ—¶åªè®°å½•æ˜¾ç¤ºä¿¡æ¯ï¼Œä¸æ”¹å˜è´¦æˆ·ä½™é¢
                            localStorage.setItem(`yesterdayEarnings_${type}`, '0');
                            localStorage.setItem(`yesterdayRate_${type}`, '0');
                            console.log(`[åˆ©æ¯è®¡ç®—] ${config.name} é›¶æ”¶ç›Šï¼Œä»…è®°å½•æ˜¾ç¤ºä¿¡æ¯`);
                        }
                    } else {
                        console.log(`[åˆ©æ¯è®¡ç®—] ${config.name} ä½™é¢ä¸º0ï¼Œè·³è¿‡è®¡ç®—`);
                    }
                });
                
                // æ›´æ–°æœ€åè®¿é—®æ—¥æœŸ
                localStorage.setItem('lastVisitDate', today);
                console.log("[åˆ©æ¯è®¡ç®—] åˆ©æ¯è®¡ç®—å®Œæˆï¼Œæ›´æ–°æœ€åè®¿é—®æ—¥æœŸ");
            } else {
                console.log("[åˆ©æ¯è®¡ç®—] ä»Šå¤©å·²ç»è®¡ç®—è¿‡åˆ©æ¯ï¼Œè·³è¿‡è®¡ç®—");
            }

            // æ˜¾ç¤ºæ˜¨æ—¥æ”¶ç›Š
            Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                const earningsElement = document.getElementById(`${type}Earnings`);
                if (earningsElement) {
                    const yesterdayEarnings = parseInt(localStorage.getItem(`yesterdayEarnings_${type}`) || '0');
                    const yesterdayRate = parseFloat(localStorage.getItem(`yesterdayRate_${type}`) || config.rate);
                    
                    // æ˜¾ç¤ºæ”¶ç›Šå’Œå®é™…åˆ©ç‡
                    if (config.hasFluctuation) {
                        const baseRatePercent = (config.rate * 100).toFixed(1);
                        const actualRatePercent = (yesterdayRate * 100).toFixed(1);
                        
                        // é¿å…é™¤ä»¥é›¶é”™è¯¯
                        let fluctuation = '0.0';
                        if (config.rate !== 0) {
                            fluctuation = ((yesterdayRate - config.rate) / config.rate * 100).toFixed(1);
                        }
                        
                        const fluctuationSign = fluctuation >= 0 ? '+' : '';
                        
                        earningsElement.innerHTML = `${yesterdayEarnings}<br><span style="font-size: 0.8rem; color: ${yesterdayRate >= 0 ? '#06d6a0' : '#ff6b6b'}">${actualRatePercent}% (${fluctuationSign}${fluctuation}%)</span>`;
                    } else {
                        earningsElement.textContent = yesterdayEarnings;
                    }
                    
                    // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                    if (yesterdayEarnings > 0) {
                        earningsElement.classList.add('animate-count-up');
                        setTimeout(() => earningsElement.classList.remove('animate-count-up'), 500);
                    }
                }
            });
        }

        // è¯Šæ–­æ ¸å¿ƒå¯¹è±¡å’Œå‡½æ•°ï¼ˆæ”¾åœ¨BANK_CONFIGå®šä¹‰ä¹‹åï¼‰
        console.log("[è¯Šæ–­] é¡µé¢åŠ è½½å¼€å§‹");
        console.log("[è¯Šæ–­] BANK_CONFIG æ˜¯å¦å®šä¹‰ï¼Ÿ", typeof BANK_CONFIG !== 'undefined' ? 'æ˜¯' : 'å¦');

        // é»˜è®¤å¯†ç 
        

        // åˆå§‹åŒ–æ•°æ®ï¼ˆåªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰§è¡Œï¼‰
        function initializeData() {
            // æ£€æŸ¥æ˜¯å¦å·²ç»åˆå§‹åŒ–è¿‡ï¼ˆä½¿ç”¨ä¸€ä¸ªæ ‡è®°ï¼‰
            const isInitialized = localStorage.getItem('bankInitialized');
            
            if (!isInitialized) {
                console.log("[åˆå§‹åŒ–] ç¬¬ä¸€æ¬¡è®¿é—®é“¶è¡Œé¡µé¢ï¼Œåˆå§‹åŒ–æ•°æ®");
                
                // åˆå§‹åŒ–å…‘æ¢åˆ¸ä½™é¢ï¼ˆä¸ä¸»é¡µé¢åŒæ­¥ï¼‰
                if (!localStorage.getItem('voucher')) {
                    localStorage.setItem('voucher', '0');
                }
                
                // åˆå§‹åŒ–é“¶è¡Œè´¦æˆ·æ•°æ®
                Object.values(BANK_CONFIG).forEach(config => {
                    if (!localStorage.getItem(config.key)) {
                        localStorage.setItem(config.key, '0');
                    }
                });

                // åˆå§‹åŒ–äº¤æ˜“å†å²
                if (!localStorage.getItem('bankTransactions')) {
                    localStorage.setItem('bankTransactions', JSON.stringify([]));
                }

                // åˆå§‹åŒ–æœ€ååˆ©æ¯è®¡ç®—æ—¥æœŸ
                if (!localStorage.getItem('lastInterestDate')) {
                    localStorage.setItem('lastInterestDate', new Date().toDateString());
                }
                
                // æ ‡è®°ä¸ºå·²åˆå§‹åŒ–
                localStorage.setItem('bankInitialized', 'true');
                console.log("[åˆå§‹åŒ–] æ•°æ®åˆå§‹åŒ–å®Œæˆ");
            } else {
                console.log("[åˆå§‹åŒ–] é“¶è¡Œæ•°æ®å·²å­˜åœ¨ï¼Œè·³è¿‡åˆå§‹åŒ–");
            }
        }

        // æ£€æŸ¥å¹¶å¤„ç†å®šæœŸå­˜æ¬¾åˆ°æœŸè‡ªåŠ¨ç»­å­˜
        function checkAndRenewDeposits() {
            console.log("[å®šæœŸå­˜æ¬¾] æ£€æŸ¥å®šæœŸå­˜æ¬¾åˆ°æœŸæƒ…å†µ");
            
            const depositRecords = JSON.parse(localStorage.getItem('bankDepositRecords') || '[]');
            const now = new Date();
            let renewed = false;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰åˆ°æœŸçš„å®šæœŸå­˜æ¬¾
            const updatedRecords = depositRecords.filter(record => {
                const maturityDate = new Date(record.maturityDate);
                
                if (maturityDate <= now) {
                    // å®šæœŸå­˜æ¬¾åˆ°æœŸï¼Œè‡ªåŠ¨ç»­å­˜
                    console.log(`[å®šæœŸå­˜æ¬¾] å‘ç°åˆ°æœŸå­˜æ¬¾ï¼Œé‡‘é¢: ${record.amount}ï¼Œè‡ªåŠ¨ç»­å­˜7å¤©`);
                    
                    // æ›´æ–°åˆ°æœŸæ—¶é—´ä¸º7å¤©å
                    record.maturityDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString();
                    renewed = true;
                    
                    // è®°å½•ç»­å­˜äº¤æ˜“
                    const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
                    transactions.push({
                        type: 'renew',
                        accountType: 'deposit',
                        accountName: 'å®šæœŸå­˜æ¬¾',
                        amount: record.amount,
                        date: new Date().toISOString(),
                        description: 'å®šæœŸå­˜æ¬¾åˆ°æœŸè‡ªåŠ¨ç»­å­˜7å¤©'
                    });
                    localStorage.setItem('bankTransactions', JSON.stringify(transactions));
                    
                    return true; // ä¿ç•™è®°å½•ï¼Œä½†æ›´æ–°åˆ°æœŸæ—¶é—´
                }
                
                return true; // ä¿ç•™æœªåˆ°æœŸçš„è®°å½•
            });
            
            if (renewed) {
                localStorage.setItem('bankDepositRecords', JSON.stringify(updatedRecords));
                console.log("[å®šæœŸå­˜æ¬¾] å®šæœŸå­˜æ¬¾è‡ªåŠ¨ç»­å­˜å®Œæˆ");
            }
            
            return renewed;
        }

        // æ›´æ–°UI
        function updateUI() {
            // å…ˆæ£€æŸ¥å®šæœŸå­˜æ¬¾åˆ°æœŸè‡ªåŠ¨ç»­å­˜
            checkAndRenewDeposits();
            
            // æ›´æ–°å½“å‰å…‘æ¢åˆ¸ä½™é¢ï¼ˆä¸ä¸»é¡µé¢åŒæ­¥ï¼‰
            const currentVoucher = parseInt(localStorage.getItem('voucher') || '0');
            document.getElementById('currentVoucherAmount').textContent = currentVoucher;
            
            // åŒæ­¥åˆ°ä¸»é¡µé¢ï¼ˆç¡®ä¿ä¸»é¡µé¢ä¹Ÿèƒ½çœ‹åˆ°æœ€æ–°æ•°æ®ï¼‰
            if (window.parent && window.parent.updateVoucherDisplay) {
                window.parent.updateVoucherDisplay();
            }

            // æ›´æ–°é“¶è¡Œè´¦æˆ·ä½™é¢
            Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                const amount = parseInt(localStorage.getItem(config.key) || '0');
                document.getElementById(type + 'Amount').textContent = amount;
                
                // æ˜¾ç¤ºå®šæœŸå­˜æ¬¾çš„è¯¦ç»†ä¿¡æ¯
                if (config.period > 0) {
                    const depositRecords = JSON.parse(localStorage.getItem(config.key + 'Records') || '[]');
                    const now = new Date();
                    const activeDeposits = depositRecords.filter(record => {
                        const maturityDate = new Date(record.maturityDate);
                        return maturityDate > now;
                    });
                    
                    const depositInfoElement = document.getElementById(type + 'Info');
                    if (depositInfoElement) {
                        if (activeDeposits.length > 0) {
                            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                            const todayDeposits = activeDeposits.filter(record => {
                                const depositDate = new Date(record.depositDate);
                                const depositDay = new Date(depositDate.getFullYear(), depositDate.getMonth(), depositDate.getDate());
                                return depositDay.getTime() === today.getTime();
                            });
                            
                            if (type === 'investment' && todayDeposits.length > 0) {
                                depositInfoElement.innerHTML = `
                                    <div>æ—¥åˆ©ç‡: <span id="${type}RateDisplay">${(config.rate * 100).toFixed(1)}%</span></div>
                                    <div>å½“æ—¥å­˜å…¥æ¬¡æ—¥å¯å–ï¼Œæœ€é«˜æ”¶ç›Š</div>
                                    <div style="color: #ff6b6b; font-size: 0.9rem; margin-top: 5px;">
                                        ğŸ“… ä»Šæ—¥å­˜å…¥ ${todayDeposits.length} ç¬”ï¼Œæ¬¡æ—¥å¯å–å‡º
                                    </div>
                                `;
                            } else if (type === 'investment') {
                                depositInfoElement.innerHTML = `
                                    <div>æ—¥åˆ©ç‡: <span id="${type}RateDisplay">${(config.rate * 100).toFixed(1)}%</span></div>
                                    <div>å½“æ—¥å­˜å…¥æ¬¡æ—¥å¯å–ï¼Œæœ€é«˜æ”¶ç›Š</div>
                                `;
                            } else if (type === 'deposit' && activeDeposits.length > 0) {
                                const earliestMaturity = new Date(Math.min(...activeDeposits.map(r => new Date(r.maturityDate))));
                                const daysLeft = Math.ceil((earliestMaturity - now) / (1000 * 60 * 60 * 24));
                                depositInfoElement.innerHTML = `
                                    <div>æ—¥åˆ©ç‡: <span id="${type}RateDisplay">${(config.rate * 100).toFixed(1)}%</span></div>
                                    <div>7å¤©æœŸé™ï¼Œæ”¶ç›Šæ›´é«˜</div>
                                    <div style="color: #ff6b6b; font-size: 0.9rem; margin-top: 5px;">
                                        ğŸ“… æœ‰ ${activeDeposits.length} ç¬”å­˜æ¬¾ï¼Œæœ€æ—© ${daysLeft} å¤©ååˆ°æœŸ
                                    </div>
                                `;
                            } else {
                                depositInfoElement.innerHTML = `
                                    <div>æ—¥åˆ©ç‡: <span id="${type}RateDisplay">${(config.rate * 100).toFixed(1)}%</span></div>
                                    <div>${type === 'deposit' ? '7å¤©æœŸé™ï¼Œæ”¶ç›Šæ›´é«˜' : 'å½“æ—¥å­˜å…¥æ¬¡æ—¥å¯å–ï¼Œæœ€é«˜æ”¶ç›Š'}</div>
                                `;
                            }
                        } else {
                            depositInfoElement.innerHTML = `
                                <div>æ—¥åˆ©ç‡: <span id="${type}RateDisplay">${(config.rate * 100).toFixed(1)}%</span></div>
                                <div>${type === 'deposit' ? '7å¤©æœŸé™ï¼Œæ”¶ç›Šæ›´é«˜' : 'å½“æ—¥å­˜å…¥æ¬¡æ—¥å¯å–ï¼Œæœ€é«˜æ”¶ç›Š'}</div>
                            `;
                        }
                    }
                }
            });

            // æ›´æ–°äº¤æ˜“å†å²
            updateTransactionHistory();
            
            // æ›´æ–°å„è´¦æˆ·çš„ç›ˆåˆ©/äºæŸè®°å½•
            updateAccountHistory();

            // è®¡ç®—å¹¶æ˜¾ç¤ºåˆ©æ¯
            calculateAndShowInterest();
        }

        // æ›´æ–°äº¤æ˜“å†å²ï¼ˆä»…æ˜¾ç¤ºå­˜å–æƒ…å†µï¼Œä¸æ˜¾ç¤ºæ”¶ç›Šï¼‰
        function updateTransactionHistory() {
            const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
            const transactionList = document.getElementById('transactionList');
            transactionList.innerHTML = '';

            // è¿‡æ»¤æ‰åˆ©æ¯äº¤æ˜“ï¼Œåªä¿ç•™å­˜å–äº¤æ˜“
            const filteredTransactions = transactions.filter(transaction => 
                transaction.type === 'deposit' || transaction.type === 'withdraw'
            );

            filteredTransactions.slice(-10).reverse().forEach(transaction => {
                const transactionItem = document.createElement('div');
                transactionItem.className = `transaction-item ${transaction.type === 'deposit' ? 'transaction-positive' : 'transaction-negative'}`;

                const amountSign = transaction.type === 'deposit' ? '+' : '-';
                const amountClass = transaction.type === 'deposit' ? 'positive' : 'negative';

                transactionItem.innerHTML = `
                    <div>
                        <div style="font-weight: bold;">${transaction.accountName}</div>
                        <div style="font-size: 0.9rem; color: #666;">${new Date(transaction.date).toLocaleString()}</div>
                    </div>
                    <div class="${amountClass}" style="font-size: 1.2rem; font-weight: bold;">
                        ${amountSign}${transaction.amount} å…‘æ¢åˆ¸
                    </div>
                `;

                transactionList.appendChild(transactionItem);
            });

            // å¦‚æœæ²¡æœ‰å­˜å–è®°å½•ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
            if (filteredTransactions.length === 0) {
                transactionList.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.9rem; padding: 20px;">æš‚æ— å­˜å–è®°å½•</div>';
            }
        }

        // è®¡ç®—å¹¶æ˜¾ç¤ºåˆ©æ¯ï¼ˆå·²åºŸå¼ƒï¼Œä½¿ç”¨ updateBankEarnings æ›¿ä»£ï¼‰
        function calculateAndShowInterest() {
            // è¿™ä¸ªå‡½æ•°ç°åœ¨åªè°ƒç”¨ç»Ÿä¸€çš„åˆ©æ¯è®¡ç®—å‡½æ•°
            updateBankEarnings();
        }

        // æ›´æ–°å„è´¦æˆ·çš„ç›ˆåˆ©/äºæŸè®°å½•
        function updateAccountHistory() {
            console.log("[å†å²è®°å½•] å¼€å§‹æ›´æ–°å„è´¦æˆ·çš„ç›ˆåˆ©/äºæŸè®°å½•");
            
            // è·å–æ‰€æœ‰äº¤æ˜“è®°å½•
            const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
            
            // è‡ªåŠ¨åˆ é™¤14å¤©å‰çš„è®°å½•
            const fourteenDaysAgo = new Date();
            fourteenDaysAgo.setDate(fourteenDaysAgo.getDate() - 14);
            
            const filteredTransactions = transactions.filter(transaction => {
                const transactionDate = new Date(transaction.date);
                return transactionDate >= fourteenDaysAgo;
            });
            
            // å¦‚æœåˆ é™¤äº†è®°å½•ï¼Œæ›´æ–°localStorage
            if (filteredTransactions.length < transactions.length) {
                localStorage.setItem('bankTransactions', JSON.stringify(filteredTransactions));
                console.log(`[å†å²è®°å½•] å·²åˆ é™¤ ${transactions.length - filteredTransactions.length} æ¡14å¤©å‰çš„è®°å½•`);
            }
            
            // æŒ‰è´¦æˆ·ç±»å‹åˆ†ç»„äº¤æ˜“è®°å½•
            const accountHistories = {
                savings: [],
                deposit: [],
                investment: []
            };
            
            // ç­›é€‰å‡ºæ‰€æœ‰äº¤æ˜“è®°å½•ï¼ˆåŒ…æ‹¬å­˜å–å’Œåˆ©æ¯ï¼‰
            transactions.forEach(transaction => {
                if (accountHistories[transaction.accountType]) {
                    accountHistories[transaction.accountType].push(transaction);
                }
            });
            
            // æ›´æ–°å„è´¦æˆ·çš„å†å²è®°å½•æ˜¾ç¤º
            Object.entries(accountHistories).forEach(([accountType, history]) => {
                const historyElement = document.getElementById(accountType + 'History');
                if (historyElement) {
                    // æŒ‰æ—¥æœŸå€’åºæ’åˆ—ï¼Œæ˜¾ç¤ºæœ€è¿‘5æ¡è®°å½•
                    const recentHistory = history
                        .sort((a, b) => new Date(b.date) - new Date(a.date))
                        .slice(0, 5);
                    
                    if (recentHistory.length === 0) {
                        historyElement.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.9rem; padding: 20px;">æš‚æ— æ”¶ç›Šè®°å½•</div>';
                    } else {
                        historyElement.innerHTML = recentHistory.map(transaction => {
                            const date = new Date(transaction.date);
                            const dateStr = `${date.getMonth() + 1}/${date.getDate()} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                            
                            let className = 'history-item';
                            let amountText = '';
                            
                            if (transaction.fluctuationType === 'profit') {
                                className += ' history-profit';
                                amountText = `+${transaction.amount}`;
                            } else if (transaction.fluctuationType === 'loss') {
                                className += ' history-loss';
                                amountText = `-${Math.abs(transaction.amount)}`;
                            } else if (transaction.fluctuationType === 'zero') {
                                className += ' history-zero';
                                amountText = '0';
                            } else {
                                className += ' history-profit';
                                amountText = `+${transaction.amount}`;
                            }
                            
                            return `
                                <div class="${className}">
                                    <div>
                                        <div class="history-amount">${amountText} å…‘æ¢åˆ¸</div>
                                        <div class="history-date">${dateStr}</div>
                                    </div>
                                    <div style="font-size: 0.8rem; color: #666;">
                                        ${transaction.fluctuationType === 'profit' ? 'ğŸ“ˆ ç›ˆåˆ©' : 
                                          transaction.fluctuationType === 'loss' ? 'ğŸ“‰ äºæŸ' : 
                                          transaction.fluctuationType === 'zero' ? 'âšª é›¶æ”¶ç›Š' : 'ğŸ’° æ”¶ç›Š'}
                                    </div>
                                </div>
                            `;
                        }).join('');
                    }
                }
            });
            
            console.log("[å†å²è®°å½•] ç›ˆåˆ©/äºæŸè®°å½•æ›´æ–°å®Œæˆ");
        }

        // æ‰“å¼€å­˜å…¥æ¨¡æ€æ¡†
        function openDepositModal(accountType) {
            console.log("[è¯Šæ–­] openDepositModal è¢«è°ƒç”¨ï¼Œè´¦æˆ·ç±»å‹:", accountType);
            const config = BANK_CONFIG[accountType];
            console.log("[è¯Šæ–­] é“¶è¡Œé…ç½®:", config);
            
            const modalTitle = document.getElementById('depositModalTitle');
            const modal = document.getElementById('depositModal');
            
            if (!modalTitle || !modal) {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°å­˜å…¥æ¨¡æ€æ¡†å…ƒç´ ï¼");
                return;
            }
            
            modalTitle.textContent = `å­˜å…¥${config.name}`;
            document.getElementById('depositAccountType').value = accountType;
            document.getElementById('depositAmount').value = '';
            modal.style.display = 'flex';
            console.log("[è¯Šæ–­] å­˜å…¥æ¨¡æ€æ¡†å·²æ‰“å¼€");
        }

        // å…³é—­å­˜å…¥æ¨¡æ€æ¡†
        function closeDepositModal() {
            document.getElementById('depositModal').style.display = 'none';
        }

        // æ‰“å¼€å–å‡ºæ¨¡æ€æ¡†
        function openWithdrawModal(accountType) {
            console.log("[è¯Šæ–­] openWithdrawModal è¢«è°ƒç”¨ï¼Œè´¦æˆ·ç±»å‹:", accountType);
            const config = BANK_CONFIG[accountType];
            console.log("[è¯Šæ–­] é“¶è¡Œé…ç½®:", config);
            
            const modalTitle = document.getElementById('withdrawModalTitle');
            const modal = document.getElementById('withdrawModal');
            
            if (!modalTitle || !modal) {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°å–å‡ºæ¨¡æ€æ¡†å…ƒç´ ï¼");
                return;
            }
            
            modalTitle.textContent = `å–å‡º${config.name}`;
            document.getElementById('withdrawAccountType').value = accountType;
            document.getElementById('withdrawAmount').value = '';
            modal.style.display = 'flex';
            console.log("[è¯Šæ–­] å–å‡ºæ¨¡æ€æ¡†å·²æ‰“å¼€");
        }

        // å…³é—­å–å‡ºæ¨¡æ€æ¡†
        function closeWithdrawModal() {
            document.getElementById('withdrawModal').style.display = 'none';
        }

        // å¤„ç†å­˜å…¥
        function processDeposit() {
            console.log("[è¯Šæ–­] processDeposit è¢«è°ƒç”¨");
            
            const accountType = document.getElementById('depositAccountType').value;
            const amountInput = document.getElementById('depositInputAmount').value;
            const amount = parseFloat(amountInput);
            
            console.log("[è¯Šæ–­] å­˜å…¥å‚æ•°:", { accountType, amount, amountInput });

            if (isNaN(amount) || amount <= 0 || amountInput.trim() === '') {
                console.error("[é”™è¯¯] å­˜å…¥æ•°é‡æ— æ•ˆ", { amount, amountInput });
                showStatus('è¯·è¾“å…¥æœ‰æ•ˆçš„å­˜å…¥æ•°é‡ï¼', 'error');
                return;
            }

            const currentVoucher = parseInt(localStorage.getItem('voucher') || '0');
            console.log("[è¯Šæ–­] å½“å‰å…‘æ¢åˆ¸ä½™é¢:", currentVoucher);
            
            if (amount > currentVoucher) {
                console.error("[é”™è¯¯] å…‘æ¢åˆ¸ä½™é¢ä¸è¶³");
                showStatus('å…‘æ¢åˆ¸ä½™é¢ä¸è¶³ï¼', 'error');
                return;
            }

            const config = BANK_CONFIG[accountType];
            const currentBankAmount = parseInt(localStorage.getItem(config.key) || '0');
            console.log("[è¯Šæ–­] é“¶è¡Œè´¦æˆ·ä½™é¢:", { accountType, currentBankAmount });
            
            // æ›´æ–°å…‘æ¢åˆ¸ä½™é¢
            localStorage.setItem('voucher', (currentVoucher - amount).toString());
            
            // æ›´æ–°é“¶è¡Œè´¦æˆ·ä½™é¢
            localStorage.setItem(config.key, (currentBankAmount + amount).toString());
            
            // å¦‚æœæ˜¯å®šæœŸå­˜æ¬¾æˆ–æŠ•èµ„ç†è´¢ï¼Œè®°å½•å­˜å…¥æ—¶é—´
            if (config.period > 0) {
                console.log(`[å­˜æ¬¾è®°å½•] è®°å½• ${config.name} å­˜å…¥æ—¶é—´ï¼ŒæœŸé™: ${config.period} å¤©`);
                const depositRecords = JSON.parse(localStorage.getItem(config.key + 'Records') || '[]');
                depositRecords.push({
                    amount: amount,
                    depositDate: new Date().toISOString(),
                    maturityDate: new Date(Date.now() + config.period * 24 * 60 * 60 * 1000).toISOString()
                });
                localStorage.setItem(config.key + 'Records', JSON.stringify(depositRecords));
            }

            // è®°å½•äº¤æ˜“
            const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
            transactions.push({
                type: 'deposit',
                accountType: accountType,
                accountName: config.name,
                amount: amount,
                date: new Date().toISOString()
            });
            localStorage.setItem('bankTransactions', JSON.stringify(transactions));

            closeDepositModal();
            updateUI();
            showStatus(`æˆåŠŸå­˜å…¥ ${amount} å…‘æ¢åˆ¸åˆ°${config.name}ï¼`, 'success');
            console.log("[è¯Šæ–­] å­˜å…¥æ“ä½œå®Œæˆ");
        }

        // å¤„ç†å–å‡º
        function processWithdraw() {
            console.log("[è¯Šæ–­] processWithdraw è¢«è°ƒç”¨");
            
            const accountType = document.getElementById('withdrawAccountType').value;
            const amountInput = document.getElementById('withdrawAmount').value;
            const amount = parseFloat(amountInput);
            
            console.log("[è¯Šæ–­] å–å‡ºå‚æ•°:", { accountType, amount, amountInput });

            if (isNaN(amount) || amount <= 0 || amountInput.trim() === '') {
                console.error("[é”™è¯¯] å–å‡ºæ•°é‡æ— æ•ˆ", { amount, amountInput });
                showStatus('è¯·è¾“å…¥æœ‰æ•ˆçš„å–å‡ºæ•°é‡ï¼', 'error');
                return;
            }

            const config = BANK_CONFIG[accountType];
            const currentBankAmount = parseInt(localStorage.getItem(config.key) || '0');
            console.log("[è¯Šæ–­] é“¶è¡Œè´¦æˆ·ä½™é¢:", { accountType, currentBankAmount });
            
            if (amount > currentBankAmount) {
                console.error("[é”™è¯¯] é“¶è¡Œè´¦æˆ·ä½™é¢ä¸è¶³");
                showStatus('é“¶è¡Œè´¦æˆ·ä½™é¢ä¸è¶³ï¼', 'error');
                return;
            }
            
            // æ£€æŸ¥å®šæœŸå­˜æ¬¾æˆ–æŠ•èµ„ç†è´¢æ˜¯å¦åœ¨æœŸé™å†…
            if (config.period > 0) {
                const depositRecords = JSON.parse(localStorage.getItem(config.key + 'Records') || '[]');
                const now = new Date();
                
                if (accountType === 'investment') {
                    // æŠ•èµ„ç†è´¢ï¼šæ£€æŸ¥æ˜¯å¦æœ‰ä»Šæ—¥å­˜å…¥çš„è®°å½•ï¼ˆæ¬¡æ—¥å¯å–ï¼‰
                    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    const todayDeposits = depositRecords.filter(record => {
                        const depositDate = new Date(record.depositDate);
                        const depositDay = new Date(depositDate.getFullYear(), depositDate.getMonth(), depositDate.getDate());
                        return depositDay.getTime() === today.getTime();
                    });
                    
                    if (todayDeposits.length > 0) {
                        console.error("[é”™è¯¯] æŠ•èµ„ç†è´¢ä»Šæ—¥å­˜å…¥çš„èµ„é‡‘ä¸å¯å–å‡º");
                        showStatus(`${config.name}ä»Šæ—¥å­˜å…¥çš„èµ„é‡‘ä¸å¯å–å‡ºï¼Œè¯·ç­‰å¾…æ¬¡æ—¥å†æ“ä½œï¼`, 'error');
                        return;
                    }
                } else if (accountType === 'deposit') {
                    // å®šæœŸå­˜æ¬¾ï¼šæ£€æŸ¥æ˜¯å¦æœ‰æœªåˆ°æœŸçš„è®°å½•ï¼ˆ7å¤©æœŸé™ï¼‰
                    const activeDeposits = depositRecords.filter(record => {
                        const maturityDate = new Date(record.maturityDate);
                        return maturityDate > now;
                    });
                    
                    if (activeDeposits.length > 0) {
                        console.error("[é”™è¯¯] å®šæœŸå­˜æ¬¾åœ¨æœŸé™å†…ï¼Œä¸å¯å–å‡º");
                        const earliestMaturity = new Date(Math.min(...activeDeposits.map(r => new Date(r.maturityDate))));
                        const daysLeft = Math.ceil((earliestMaturity - now) / (1000 * 60 * 60 * 24));
                        showStatus(`${config.name}æœ‰ ${activeDeposits.length} ç¬”å­˜æ¬¾åœ¨æœŸé™å†…ï¼Œæœ€æ—© ${daysLeft} å¤©ååˆ°æœŸï¼è¯·ç­‰å¾…åˆ°æœŸåå†æ“ä½œã€‚`, 'error');
                        return;
                    }
                }
            }

            const currentVoucher = parseInt(localStorage.getItem('voucher') || '0');
            console.log("[è¯Šæ–­] å½“å‰å…‘æ¢åˆ¸ä½™é¢:", currentVoucher);
            
            // æ›´æ–°é“¶è¡Œè´¦æˆ·ä½™é¢
            localStorage.setItem(config.key, (currentBankAmount - amount).toString());
            
            // æ›´æ–°å…‘æ¢åˆ¸ä½™é¢
            localStorage.setItem('voucher', (currentVoucher + amount).toString());
            
            // å¦‚æœæ˜¯å®šæœŸå­˜æ¬¾æˆ–æŠ•èµ„ç†è´¢ï¼Œæ›´æ–°å­˜æ¬¾è®°å½•ï¼ˆç§»é™¤å·²å–å‡ºçš„è®°å½•ï¼‰
            if (config.period > 0) {
                const depositRecords = JSON.parse(localStorage.getItem(config.key + 'Records') || '[]');
                const now = new Date();
                
                // æ¨¡æ‹Ÿå–å‡ºæ“ä½œï¼šä»æœ€æ–°çš„è®°å½•å¼€å§‹å–å‡º
                let remainingAmount = amount;
                const updatedRecords = [];
                
                // æŒ‰å­˜å…¥æ—¶é—´æ’åºï¼ˆä»æ—§åˆ°æ–°ï¼‰
                const sortedRecords = depositRecords.sort((a, b) => new Date(a.depositDate) - new Date(b.depositDate));
                
                for (const record of sortedRecords) {
                    if (remainingAmount <= 0) {
                        updatedRecords.push(record);
                        continue;
                    }
                    
                    if (record.amount <= remainingAmount) {
                        // å®Œå…¨å–å‡ºè¿™ç¬”è®°å½•
                        remainingAmount -= record.amount;
                    } else {
                        // éƒ¨åˆ†å–å‡ºè¿™ç¬”è®°å½•
                        record.amount -= remainingAmount;
                        updatedRecords.push(record);
                        remainingAmount = 0;
                    }
                }
                
                localStorage.setItem(config.key + 'Records', JSON.stringify(updatedRecords));
            }

            // è®°å½•äº¤æ˜“
            const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
            transactions.push({
                type: 'withdraw',
                accountType: accountType,
                accountName: config.name,
                amount: amount,
                date: new Date().toISOString()
            });
            localStorage.setItem('bankTransactions', JSON.stringify(transactions));

            closeWithdrawModal();
            updateUI();
            showStatus(`æˆåŠŸä»${config.name}å–å‡º ${amount} å…‘æ¢åˆ¸ï¼`, 'success');
            console.log("[è¯Šæ–­] å–å‡ºæ“ä½œå®Œæˆ");
        }

        // æ‰“å¼€è®¾ç½®æ¨¡æ€æ¡†ï¼ˆéœ€è¦å¯†ç éªŒè¯ï¼‰
        function openSettingsModal() {
            console.log("[è¯Šæ–­] openSettingsModal è¢«è°ƒç”¨");
            
            // æ‰“å¼€å¯†ç éªŒè¯æ¨¡æ€æ¡†
            openPasswordVerifyModal();
        }

        // æ‰“å¼€å¯†ç éªŒè¯æ¨¡æ€æ¡†
        function openPasswordVerifyModal() {
            console.log("[è¯Šæ–­] æ‰“å¼€å¯†ç éªŒè¯æ¨¡æ€æ¡†");
            
            const passwordModal = document.getElementById('passwordVerifyModal');
            if (!passwordModal) {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°å¯†ç éªŒè¯æ¨¡æ€æ¡†ï¼");
                return;
            }
            
            passwordModal.style.display = 'flex';
            document.getElementById('verifyPassword').value = '';
            document.getElementById('verifyPassword').focus();
            console.log("[è¯Šæ–­] å¯†ç éªŒè¯æ¨¡æ€æ¡†å·²æ‰“å¼€");
        }

        // å…³é—­å¯†ç éªŒè¯æ¨¡æ€æ¡†
        function closePasswordVerifyModal() {
            const passwordModal = document.getElementById('passwordVerifyModal');
            if (passwordModal) {
                passwordModal.style.display = 'none';
            }
        }

        // éªŒè¯é“¶è¡Œè®¾ç½®å¯†ç 
        function verifyBankPassword() {
            const password = document.getElementById('verifyPassword').value;
            // ä»localStorageè·å–å¯†ç ï¼Œä¸index.htmlä¿æŒä¸€è‡´
            const storedPassword = localStorage.getItem('password') || '1234';
            
            if (password === storedPassword) {
                closePasswordVerifyModal();
                openSettingsModalDirect(); // å¯†ç éªŒè¯é€šè¿‡åç›´æ¥æ‰“å¼€è®¾ç½®æ¨¡æ€æ¡†
            } else {
                showStatus('å¯†ç é”™è¯¯ï¼', "error");
                document.getElementById('verifyPassword').value = '';
                document.getElementById('verifyPassword').focus();
            }
        }

        // ç›´æ¥æ‰“å¼€è®¾ç½®æ¨¡æ€æ¡†ï¼ˆå¯†ç éªŒè¯é€šè¿‡åè°ƒç”¨ï¼‰
        function openSettingsModalDirect() {
            console.log("[è¯Šæ–­] openSettingsModalDirect è¢«è°ƒç”¨");
            
            const settingsModal = document.getElementById('settingsModal');
            if (!settingsModal) {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°é“¶è¡Œè®¾ç½®æ¨¡æ€æ¡†ï¼");
                return;
            }
            
            console.log("[è¯Šæ–­] é“¶è¡Œè®¾ç½®æ¨¡æ€æ¡†å­˜åœ¨ï¼Œå¼€å§‹è®¾ç½®å€¼");
            
            const savingsRateInput = document.getElementById('savingsRate');
            const depositRateInput = document.getElementById('depositRate');
            const investmentRateInput = document.getElementById('investmentRate');
            const riskMinLossInput = document.getElementById('riskMinLoss');
            const riskMaxProfitInput = document.getElementById('riskMaxProfit');
            
            if (!savingsRateInput || !depositRateInput || !investmentRateInput || !riskMinLossInput || !riskMaxProfitInput) {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°è®¾ç½®è¾“å…¥æ¡†ï¼");
                return;
            }
            
            savingsRateInput.value = (BANK_CONFIG.savings.rate * 100).toFixed(2);
            depositRateInput.value = (BANK_CONFIG.deposit.rate * 100).toFixed(2);
            investmentRateInput.value = (BANK_CONFIG.investment.rate * 100).toFixed(2);
            
            // è®¾ç½®é£é™©æ³¢åŠ¨èŒƒå›´
            riskMinLossInput.value = (RISK_CONFIG.minLoss * 100).toFixed(0);
            riskMaxProfitInput.value = (RISK_CONFIG.maxProfit * 100).toFixed(0);
            
            // æ›´æ–°å½“å‰é…ç½®é¢„è§ˆ
            updateRiskRangeDisplay();
            
            // é»˜è®¤æ˜¾ç¤ºåˆ©ç‡è®¾ç½®æ ‡ç­¾é¡µ
            switchSettingsTab('rates');
            
            settingsModal.style.display = 'flex';
            console.log("[è¯Šæ–­] é“¶è¡Œè®¾ç½®æ¨¡æ€æ¡†å·²æ‰“å¼€");
        }
        
        // æ›´æ–°é£é™©èŒƒå›´æ˜¾ç¤º
        function updateRiskRangeDisplay() {
            const minLoss = document.getElementById('riskMinLoss').value;
            const maxProfit = document.getElementById('riskMaxProfit').value;
            const currentRiskRange = document.getElementById('currentRiskRange');
            
            if (currentRiskRange) {
                currentRiskRange.textContent = `${minLoss}% ~ +${maxProfit}%`;
            }
        }

        // åˆ‡æ¢è®¾ç½®æ ‡ç­¾é¡µ
        function switchSettingsTab(tabId) {
            console.log("[è¯Šæ–­] switchSettingsTab è¢«è°ƒç”¨ï¼Œæ ‡ç­¾é¡µID:", tabId);
            
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('#settingsModal .tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // å–æ¶ˆæ‰€æœ‰æ ‡ç­¾çš„æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('#settingsModal .nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            const targetTab = document.getElementById(tabId);
            if (targetTab) {
                targetTab.classList.add('active');
                console.log("[è¯Šæ–­] æ ‡ç­¾å†…å®¹å·²æ˜¾ç¤º:", tabId);
            } else {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°æ ‡ç­¾å†…å®¹:", tabId);
            }
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
            document.querySelectorAll('#settingsModal .nav-tab').forEach(tab => {
                const onclickAttr = tab.getAttribute('onclick');
                if (onclickAttr && onclickAttr.includes(tabId)) {
                    tab.classList.add('active');
                    console.log("[è¯Šæ–­] æ ‡ç­¾æŒ‰é’®å·²æ¿€æ´»:", tab.textContent);
                }
            });
            
            // å¦‚æœåˆ‡æ¢åˆ°è®°å½•ç®¡ç†æ ‡ç­¾é¡µï¼Œæ›´æ–°è®°å½•ç»Ÿè®¡
            if (tabId === 'records') {
                updateRecordsStats();
            }
            
            // å¦‚æœåˆ‡æ¢åˆ°è®°å½•ç®¡ç†æ ‡ç­¾é¡µï¼Œæ›´æ–°è®°å½•ç»Ÿè®¡
            if (tabId === 'records') {
                updateRecordsStats();
            }
        }

        // æ›´æ–°é£é™©ç­‰çº§æ˜¾ç¤º
        function updateRiskDisplay(riskLevel) {
            const riskValue = document.getElementById('riskValue');
            const riskDescription = document.getElementById('riskDescription');
            const multiplierValue = document.getElementById('multiplierValue');
            const riskMultiplier = document.getElementById('riskMultiplier');
            const riskDisplay = document.querySelector('.risk-display');
            
            if (!riskValue || !riskDescription || !multiplierValue || !riskMultiplier || !riskDisplay) {
                return;
            }
            
            riskValue.textContent = riskLevel;
            
            let description = '';
            let multiplier = 1.0;
            let riskColor = '';
            let riskDetails = '';
            
            if (riskLevel <= 3) {
                description = 'ä¿å®ˆå‹';
                multiplier = 1.0;
                riskColor = 'linear-gradient(135deg, #06d6a0, #118ab2)';
                riskDetails = 'ç¨³å®šæ”¶ç›Šï¼Œæ— é£é™©æ³¢åŠ¨ï¼Œé€‚åˆé£é™©æ‰¿å—èƒ½åŠ›è¾ƒä½çš„ç”¨æˆ·';
            } else if (riskLevel <= 6) {
                description = 'å¹³è¡¡å‹';
                multiplier = 1.0 + (riskLevel - 3) * 0.2;
                riskColor = 'linear-gradient(135deg, #ffd166, #ff9e00)';
                riskDetails = 'ä¸­ç­‰æ”¶ç›Šï¼Œè½»å¾®æ³¢åŠ¨ï¼Œé€‚åˆè¿½æ±‚å¹³è¡¡çš„ç”¨æˆ·';
            } else if (riskLevel <= 8) {
                description = 'è¿›å–å‹';
                multiplier = 1.6 + (riskLevel - 6) * 0.3;
                riskColor = 'linear-gradient(135deg, #ff9e00, #ff6b6b)';
                riskDetails = 'è¾ƒé«˜æ”¶ç›Šï¼Œä¸­ç­‰æ³¢åŠ¨ï¼Œé€‚åˆæœ‰ä¸€å®šé£é™©æ‰¿å—èƒ½åŠ›çš„ç”¨æˆ·';
            } else {
                description = 'æ¿€è¿›å‹';
                multiplier = 2.2 + (riskLevel - 8) * 0.4;
                riskColor = 'linear-gradient(135deg, #ff6b6b, #ef476f)';
                riskDetails = 'æœ€é«˜æ”¶ç›Šï¼Œé«˜é£é™©æ³¢åŠ¨ï¼Œé€‚åˆé£é™©æ‰¿å—èƒ½åŠ›å¼ºçš„ç”¨æˆ·';
            }
            
            riskDescription.textContent = description;
            multiplierValue.textContent = multiplier.toFixed(1) + 'x';
            riskMultiplier.value = multiplier.toFixed(1);
            
            // åŠ¨æ€æ›´æ–°é£é™©æ˜¾ç¤ºåŒºåŸŸçš„é¢œè‰²
            riskDisplay.style.background = riskColor;
            
            // æ›´æ–°é£é™©è¯¦æƒ…æè¿°
            const existingDetails = document.getElementById('riskDetails');
            if (existingDetails) {
                existingDetails.textContent = riskDetails;
            } else {
                const riskDetailsElement = document.createElement('div');
                riskDetailsElement.id = 'riskDetails';
                riskDetailsElement.style.cssText = 'font-size: 0.9rem; margin-top: 8px; opacity: 0.9;';
                riskDetailsElement.textContent = riskDetails;
                riskDisplay.appendChild(riskDetailsElement);
            }
            
            console.log("[è¯Šæ–­] é£é™©ç­‰çº§æ›´æ–°:", { riskLevel, description, multiplier, riskDetails });
        }

        // æ¢å¤é»˜è®¤è®¾ç½®
        function resetToDefault() {
            document.getElementById('savingsRate').value = '0.1';
            document.getElementById('depositRate').value = '0.3';
            document.getElementById('investmentRate').value = '0.5';
            document.getElementById('riskMinLoss').value = '-18';
            document.getElementById('riskMaxProfit').value = '25';
            updateRiskRangeDisplay();
            
            showStatus('å·²æ¢å¤é»˜è®¤è®¾ç½®ï¼', 'warning');
        }

        // å…³é—­è®¾ç½®æ¨¡æ€æ¡†
        function closeSettingsModal() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        // ä¿å­˜è®¾ç½®
        function saveSettings() {
            console.log("[è¯Šæ–­] saveSettings è¢«è°ƒç”¨");
            
            const savingsRate = parseFloat(document.getElementById('savingsRate').value) / 100;
            const depositRate = parseFloat(document.getElementById('depositRate').value) / 100;
            const investmentRate = parseFloat(document.getElementById('investmentRate').value) / 100;
            const riskMinLoss = parseFloat(document.getElementById('riskMinLoss').value) / 100;
            const riskMaxProfit = parseFloat(document.getElementById('riskMaxProfit').value) / 100;

            console.log("[è¯Šæ–­] è®¾ç½®å€¼:", { savingsRate, depositRate, investmentRate, riskMinLoss, riskMaxProfit });

            if (isNaN(savingsRate) || isNaN(depositRate) || isNaN(investmentRate) || isNaN(riskMinLoss) || isNaN(riskMaxProfit)) {
                console.error("[é”™è¯¯] è®¾ç½®å€¼æ— æ•ˆ");
                showStatus('è¯·è¾“å…¥æœ‰æ•ˆçš„è®¾ç½®å€¼ï¼', 'error');
                return;
            }

            // éªŒè¯åˆ©ç‡è®¾ç½®æ˜¯å¦åˆç†
            if (savingsRate > 0.1 || depositRate > 0.5 || investmentRate > 1.0) {
                const confirmHighRates = confirm('æ‚¨è®¾ç½®çš„åˆ©ç‡è¾ƒé«˜ï¼Œå¯èƒ½ä¼šå½±å“æ¸¸æˆå¹³è¡¡ã€‚ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ');
                if (!confirmHighRates) {
                    return;
                }
            }

            // éªŒè¯é£é™©æ³¢åŠ¨èŒƒå›´è®¾ç½®
            if (riskMinLoss > 0 || riskMaxProfit < 0) {
                showStatus('é£é™©æ³¢åŠ¨èŒƒå›´è®¾ç½®æ— æ•ˆï¼äºæŸæ¯”ä¾‹åº”ä¸ºè´Ÿæ•°ï¼Œç›ˆåˆ©æ¯”ä¾‹åº”ä¸ºæ­£æ•°ã€‚', 'error');
                return;
            }

            if (Math.abs(riskMinLoss) > 1.0 || riskMaxProfit > 1.0) {
                const confirmHighRisk = confirm('æ‚¨è®¾ç½®çš„é£é™©æ³¢åŠ¨èŒƒå›´è¾ƒå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”¶ç›Šæ³¢åŠ¨å‰§çƒˆã€‚ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ');
                if (!confirmHighRisk) {
                    return;
                }
            }

            // ä¿å­˜è®¾ç½®åˆ°localStorage
            localStorage.setItem('bankSavingsRate', savingsRate.toString());
            localStorage.setItem('bankDepositRate', depositRate.toString());
            localStorage.setItem('bankInvestmentRate', investmentRate.toString());
            localStorage.setItem('riskMinLoss', riskMinLoss.toString());
            localStorage.setItem('riskMaxProfit', riskMaxProfit.toString());

            // æ›´æ–°BANK_CONFIG
            BANK_CONFIG.savings.rate = savingsRate;
            BANK_CONFIG.deposit.rate = depositRate;
            BANK_CONFIG.investment.rate = investmentRate;

            // æ›´æ–°RISK_CONFIG
            RISK_CONFIG.minLoss = riskMinLoss;
            RISK_CONFIG.maxProfit = riskMaxProfit;

            // æ›´æ–°åˆ©ç‡æ˜¾ç¤ºå’Œæ˜¨æ—¥æ”¶ç›Š
            updateRateDisplays();
            updateBankEarnings();

            closeSettingsModal();
            showStatus('é“¶è¡Œè®¾ç½®å·²ä¿å­˜ï¼æ–°çš„è®¾ç½®å°†åœ¨ä¸‹æ¬¡å­˜å–æ¬¾æ—¶ç”Ÿæ•ˆã€‚', 'success');
            console.log("[è¯Šæ–­] é“¶è¡Œè®¾ç½®å·²ä¿å­˜");
        }



        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(message, type) {
            const status = document.createElement('div');
            status.className = `status-message status-${type}`;
            status.textContent = message;
            
            document.body.appendChild(status);
            
            setTimeout(() => {
                status.remove();
            }, 3000);
        }

        // æ¸…ç©ºæ”¶ç›Šè®°å½•å’Œäº¤æ˜“è®°å½•
        function clearEarningsRecords() {
            // ç¬¬ä¸€æ¬¡ç¡®è®¤
            if (!confirm('âš ï¸ ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è®°å½•å—ï¼Ÿæ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤æ‰€æœ‰å†å²è®°å½•ï¼ŒåŒ…æ‹¬æ”¶ç›Šè®°å½•ã€äº¤æ˜“è®°å½•ã€åˆ©æ¯æ”¶ç›Šã€æŠ•èµ„ç›ˆäºç­‰æ‰€æœ‰è®°å½•ï¼Œæ— æ³•æ¢å¤ï¼')) {
                return;
            }
            
            // ç¬¬äºŒæ¬¡ç¡®è®¤ï¼Œç®€å•çš„ç¡®è®¤æ¡†
            if (!confirm('âš ï¸ äºŒæ¬¡ç¡®è®¤ï¼šæ‚¨ç¡®å®šè¦æ°¸ä¹…åˆ é™¤æ‰€æœ‰è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                showStatus('æ“ä½œå·²å–æ¶ˆï¼Œè®°å½•æœªè¢«åˆ é™¤ã€‚', 'warning');
                return;
            }
            
            // æ¸…ç©ºæ‰€æœ‰è´¦æˆ·çš„æ”¶ç›Šè®°å½•
            Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                localStorage.removeItem(config.key + 'History');
            });
            
            // æ¸…ç©ºé“¶è¡Œæ€»æ”¶ç›Šè®°å½•
            localStorage.removeItem('bankEarningsHistory');
            
            // æ¸…ç©ºäº¤æ˜“è®°å½•
            localStorage.setItem('bankTransactions', JSON.stringify([]));
            
            // æ¸…ç©ºå®šæœŸå­˜æ¬¾è®°å½•
            localStorage.removeItem('bankDepositRecords');
            
            // æ›´æ–°è®°å½•ç»Ÿè®¡æ˜¾ç¤º
            updateRecordsStats();
            
            // æ›´æ–°äº¤æ˜“å†å²æ˜¾ç¤º
            updateTransactionHistory();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showStatus('âœ… æ‰€æœ‰è®°å½•å·²æˆåŠŸæ¸…ç©ºï¼', 'success');
            
            console.log('[è®°å½•ç®¡ç†] æ‰€æœ‰è®°å½•å·²æ¸…ç©º');
        }

        // æ›´æ–°è®°å½•ç»Ÿè®¡æ˜¾ç¤º
        function updateRecordsStats() {
            const statsElement = document.getElementById('recordsStats');
            if (!statsElement) return;
            
            let totalRecords = 0;
            let statsHTML = '<div style="text-align: left;">';
            
            // ç»Ÿè®¡å„è´¦æˆ·çš„è®°å½•æ•°é‡
            Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                const history = JSON.parse(localStorage.getItem(config.key + 'History') || '[]');
                const count = history.length;
                totalRecords += count;
                
                statsHTML += `<div style="margin-bottom: 8px;">
                    <span style="font-weight: bold;">${config.name}ï¼š</span>
                    <span style="color: ${count > 0 ? '#06d6a0' : '#666'};">${count} æ¡è®°å½•</span>
                </div>`;
            });
            
            // ç»Ÿè®¡é“¶è¡Œæ€»æ”¶ç›Šè®°å½•
            const bankHistory = JSON.parse(localStorage.getItem('bankEarningsHistory') || '[]');
            const bankCount = bankHistory.length;
            totalRecords += bankCount;
            
            statsHTML += `<div style="margin-bottom: 8px;">
                <span style="font-weight: bold;">é“¶è¡Œæ€»æ”¶ç›Šï¼š</span>
                <span style="color: ${bankCount > 0 ? '#06d6a0' : '#666'};">${bankCount} æ¡è®°å½•</span>
            </div>`;
            
            // ç»Ÿè®¡äº¤æ˜“è®°å½•
            const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
            const transactionCount = transactions.length;
            totalRecords += transactionCount;
            
            statsHTML += `<div style="margin-bottom: 8px;">
                <span style="font-weight: bold;">äº¤æ˜“è®°å½•ï¼š</span>
                <span style="color: ${transactionCount > 0 ? '#06d6a0' : '#666'};">${transactionCount} æ¡è®°å½•</span>
            </div>`;
            
            statsHTML += `<div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid #ddd;">
                <span style="font-weight: bold; color: #ff6b6b;">æ€»è®¡ï¼š${totalRecords} æ¡è®°å½•</span>
            </div>`;
            
            statsHTML += '</div>';
            statsElement.innerHTML = statsHTML;
        }

        // è®¾ç½®ä¸»é¢˜
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme === 'default' ? '' : theme);
            
            // æ›´æ–°ä¸»é¢˜æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // è¿”å›ä¸»é¡µ
        function goBack() {
            window.location.href = '../index.html';
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log("[è¯Šæ–­] DOMContentLoaded äº‹ä»¶è§¦å‘");
            
            // æ£€æŸ¥æŒ‰é’®ç»‘å®š
            console.log("[è¯Šæ–­] æ£€æŸ¥æŒ‰é’®ç»‘å®šçŠ¶æ€");
            
            // æ£€æŸ¥é“¶è¡Œè®¾ç½®æŒ‰é’®
            const settingsBtn = document.querySelector('button[onclick*="openSettingsModal"]');
            console.log("[è¯Šæ–­] é“¶è¡Œè®¾ç½®æŒ‰é’®:", settingsBtn ? 'æ‰¾åˆ°' : 'æœªæ‰¾åˆ°');
            
            // æ£€æŸ¥å­˜æ¬¾æŒ‰é’®
            const depositBtns = document.querySelectorAll('button[onclick*="openDepositModal"]');
            console.log("[è¯Šæ–­] å­˜æ¬¾æŒ‰é’®æ•°é‡:", depositBtns.length);
            
            // æ£€æŸ¥å–æ¬¾æŒ‰é’®
            const withdrawBtns = document.querySelectorAll('button[onclick*="openWithdrawModal"]');
            console.log("[è¯Šæ–­] å–æ¬¾æŒ‰é’®æ•°é‡:", withdrawBtns.length);
            
            // æ£€æŸ¥æ¨¡æ€æ¡†å…ƒç´ 
            const depositModal = document.getElementById('depositModal');
            const withdrawModal = document.getElementById('withdrawModal');
            const settingsModal = document.getElementById('settingsModal');
            console.log("[è¯Šæ–­] æ¨¡æ€æ¡†çŠ¶æ€:", {
                depositModal: depositModal ? 'æ‰¾åˆ°' : 'æœªæ‰¾åˆ°',
                withdrawModal: withdrawModal ? 'æ‰¾åˆ°' : 'æœªæ‰¾åˆ°',
                settingsModal: settingsModal ? 'æ‰¾åˆ°' : 'æœªæ‰¾åˆ°'
            });
            
            initializeData();
            updateUI(); // æ›´æ–°UIæ˜¾ç¤ºæœ€æ–°æ•°æ®ï¼ˆåŒ…å«åˆ©æ¯è®¡ç®—ï¼‰
            updateRateDisplays();
            
            // é¡µé¢åŠ è½½æ—¶æ›´æ–°ä¸€æ¬¡UI
            
            console.log("[è¯Šæ–­] é¡µé¢åˆå§‹åŒ–å®Œæˆ");
        });



        // è®¡ç®—æ‰€æœ‰å­˜æ¬¾é¡¹ç›®çš„æ€»ä½™é¢
        function calculateTotalDeposits() {
            let total = 0;
            Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                const amount = parseInt(localStorage.getItem(config.key) || '0');
                total += amount;
            });
            return total;
        }
        
        // æ ¹æ®æ€»ä½™é¢è®¡ç®—è¶…çº§å¿«è¿›è´¹ç”¨
        function calculateSuperFastForwardCost(totalDeposits) {
            if (totalDeposits < 1000) {
                return { type: 'lottery', amount: 3, name: 'æŠ½å¥–åˆ¸' };
            } else if (totalDeposits < 2300) {
                return { type: 'lottery', amount: 5, name: 'æŠ½å¥–åˆ¸' };
            } else if (totalDeposits < 3600) {
                return { type: 'lottery', amount: 9, name: 'æŠ½å¥–åˆ¸' };
            } else if (totalDeposits < 6000) {
                return { type: 'lottery', amount: 15, name: 'æŠ½å¥–åˆ¸' };
            } else {
                return { type: 'premium', amount: 5, name: 'é«˜çº§æŠ½å¥–åˆ¸' };
            }
        }
        
        // æ‰“å¼€è¶…çº§å¿«è¿›æ¨¡æ€æ¡†
        function simulateNextDay() {
            console.log("[è¶…çº§å¿«è¿›] æ‰“å¼€è¶…çº§å¿«è¿›æ¨¡æ€æ¡†");
            
            // è®¡ç®—æ€»å­˜æ¬¾ä½™é¢
            const totalDeposits = calculateTotalDeposits();
            console.log("[è¶…çº§å¿«è¿›] æ€»å­˜æ¬¾ä½™é¢:", totalDeposits);
            
            // è®¡ç®—è´¹ç”¨
            const cost = calculateSuperFastForwardCost(totalDeposits);
            console.log("[è¶…çº§å¿«è¿›] è´¹ç”¨è®¡ç®—:", cost);
            
            // æ£€æŸ¥è´§å¸æ•°é‡
            const currentAmount = parseInt(localStorage.getItem(cost.type) || '0');
            console.log("[è¶…çº§å¿«è¿›] å½“å‰è´§å¸æ•°é‡:", currentAmount);
            
            const modal = document.getElementById('simulateNextDayModal');
            const content = document.getElementById('simulateNextDayContent');
            const confirmBtn = document.getElementById('confirmSimulateBtn');
            
            if (!modal || !content || !confirmBtn) {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°è¶…çº§å¿«è¿›æ¨¡æ€æ¡†å…ƒç´ ï¼");
                return;
            }
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            confirmBtn.textContent = 'ç¡®è®¤å¿«è¿›';
            confirmBtn.style.display = 'none';
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            confirmBtn.textContent = 'ç¡®è®¤å¿«è¿›';
            confirmBtn.style.display = 'none';
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            confirmBtn.textContent = 'ç¡®è®¤å¿«è¿›';
            confirmBtn.style.display = 'none';
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            confirmBtn.textContent = 'ç¡®è®¤å¿«è¿›';
            confirmBtn.style.display = 'none';
            
            if (currentAmount < cost.amount) {
                // è´§å¸ä¸è¶³çš„æƒ…å†µ
                content.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 48px; margin-bottom: 15px;">âŒ</div>
                        <h3 style="color: #ff6b6b; margin-bottom: 15px;">${cost.name}ä¸è¶³</h3>
                        <p style="margin-bottom: 10px;">éœ€è¦${cost.amount}å¼ ${cost.name}æ‰èƒ½ä½¿ç”¨è¶…çº§å¿«è¿›åŠŸèƒ½ã€‚</p>
                        <p style="color: #666; font-size: 14px;">å½“å‰å‰©ä½™ï¼š<strong>${currentAmount}</strong> å¼ ${cost.name}</p>
                        <p style="color: #666; font-size: 14px; margin-top: 15px;">æ‚¨å¯ä»¥åœ¨ä¸»é¡µé¢æˆ–æŠ½å¥–é¡µé¢è·å–${cost.name}ã€‚</p>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <p style="margin: 5px 0;"><strong>å½“å‰æ€»å­˜æ¬¾ï¼š</strong>${totalDeposits}å…‘æ¢åˆ¸</p>
                            <p style="margin: 5px 0;"><strong>è´¹ç”¨é˜¶æ¢¯ï¼š</strong></p>
                            <ul style="text-align: left; margin: 5px 0; font-size: 12px;">
                                <li>æ€»å­˜æ¬¾ &lt; 1000ï¼š3æŠ½å¥–åˆ¸/æ¬¡</li>
                                <li>1000 â‰¤ æ€»å­˜æ¬¾ &lt; 2300ï¼š5æŠ½å¥–åˆ¸/æ¬¡</li>
                                <li>2300 â‰¤ æ€»å­˜æ¬¾ &lt; 3600ï¼š9æŠ½å¥–åˆ¸/æ¬¡</li>
                                <li>3600 â‰¤ æ€»å­˜æ¬¾ &lt; 6000ï¼š15æŠ½å¥–åˆ¸/æ¬¡</li>
                                <li>æ€»å­˜æ¬¾ â‰¥ 6000ï¼š5é«˜çº§æŠ½å¥–åˆ¸/æ¬¡</li>
                            </ul>
                        </div>
                    </div>
                `;
                confirmBtn.style.display = 'none';
            } else {
                // è´§å¸è¶³å¤Ÿçš„æƒ…å†µ
                content.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸš€</div>
                        <h3 style="color: #06d6a0; margin-bottom: 15px;">è¶…çº§å¿«è¿›</h3>
                        <p style="margin-bottom: 15px;">ç«‹å³æ¨¡æ‹Ÿæ¬¡æ—¥åˆ©æ¯è®¡ç®—ï¼ŒæŸ¥çœ‹æ”¶ç›Šå˜åŒ–</p>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <p style="margin: 5px 0;"><strong>æ€»å­˜æ¬¾ï¼š</strong>${totalDeposits}å…‘æ¢åˆ¸</p>
                            <p style="margin: 5px 0;"><strong>æ¶ˆè€—ï¼š</strong>${cost.amount}å¼ ${cost.name}</p>
                            <p style="margin: 5px 0;"><strong>å½“å‰å‰©ä½™ï¼š</strong>${currentAmount}å¼ </p>
                            <p style="margin: 5px 0;"><strong>æ“ä½œåå‰©ä½™ï¼š</strong>${currentAmount - cost.amount}å¼ </p>
                        </div>
                        <div style="background: #f0f8ff; padding: 10px; border-radius: 8px; margin: 10px 0;">
                            <p style="font-size: 12px; color: #666; margin-bottom: 5px;"><strong>è´¹ç”¨é˜¶æ¢¯ï¼š</strong></p>
                            <ul style="text-align: left; margin: 0; font-size: 11px; padding-left: 15px;">
                                <li>&lt;1000ï¼š3æŠ½å¥–åˆ¸</li>
                                <li>1000-2299ï¼š5æŠ½å¥–åˆ¸</li>
                                <li>2300-3599ï¼š9æŠ½å¥–åˆ¸</li>
                                <li>3600-5999ï¼š15æŠ½å¥–åˆ¸</li>
                                <li>â‰¥6000ï¼š5é«˜çº§æŠ½å¥–åˆ¸</li>
                            </ul>
                        </div>
                    </div>
                `;
                confirmBtn.style.display = 'inline-block';
                confirmBtn.onclick = function() {
                    executeSimulateNextDay(currentAmount, cost);
                };
            }
            
            modal.style.display = 'flex';
            console.log("[è¶…çº§å¿«è¿›] è¶…çº§å¿«è¿›æ¨¡æ€æ¡†å·²æ‰“å¼€");
        }
        
        // æ‰§è¡Œè¶…çº§å¿«è¿›æ“ä½œ
        function executeSimulateNextDay(currentAmount, cost) {
            console.log("[è¶…çº§å¿«è¿›] å¼€å§‹æ‰§è¡Œè¶…çº§å¿«è¿›æ“ä½œ");
            
            // æ‰£é™¤ç›¸åº”è´§å¸
            const newAmount = currentAmount - cost.amount;
            localStorage.setItem(cost.type, newAmount.toString());
            console.log(`[è¶…çº§å¿«è¿›] æ‰£é™¤${cost.amount}å¼ ${cost.name}ï¼Œå‰©ä½™:`, newAmount);
            
            // è·å–å½“å‰æ—¥æœŸ
            const currentDate = new Date();
            console.log("[è¶…çº§å¿«è¿›] å½“å‰æ—¥æœŸ:", currentDate.toDateString());
            
            // è·å–æœ€åè®¿é—®æ—¥æœŸ
            const lastVisitDate = localStorage.getItem('lastVisitDate');
            console.log("[è¶…çº§å¿«è¿›] æœ€åè®¿é—®æ—¥æœŸ:", lastVisitDate);
            
            // æ¨¡æ‹Ÿæ¬¡æ—¥ï¼šå°†æœ€åè®¿é—®æ—¥æœŸè®¾ç½®ä¸ºæ˜¨å¤©
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toDateString();
            
            localStorage.setItem('lastVisitDate', yesterdayStr);
            console.log("[è¶…çº§å¿«è¿›] è®¾ç½®æœ€åè®¿é—®æ—¥æœŸä¸º:", yesterdayStr);
            
            // è®¾ç½®è¶…çº§å¿«è¿›æ ‡è®°ï¼Œé˜²æ­¢åˆ·æ–°é¡µé¢æ—¶é‡å¤è®¡ç®—
            localStorage.setItem('superFastForwardUsed', 'true');
            
            // æ›´æ–°UIæ˜¾ç¤ºï¼ˆæ­¤æ—¶ä¸ä¼šè®¡ç®—åˆ©æ¯ï¼Œå› ä¸ºæ—¥æœŸå·²ç»è®¾ç½®ä¸ºæ˜¨å¤©ï¼‰
            updateUI();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯æ¨¡æ€æ¡†
            showSimulateNextDayResult(newAmount, cost);
            
            console.log("[è¶…çº§å¿«è¿›] æ¨¡æ‹Ÿå®Œæˆï¼ŒUIå·²æ›´æ–°");
        }
        
        // ä½¿ç”¨ä¸ä¸»é¡µé¢å®Œå…¨ä¸€è‡´çš„åˆ©æ¯è®¡ç®—é€»è¾‘
        function simulateMainPageInterestCalculation() {
            console.log("[æ¨¡æ‹Ÿæ¬¡æ—¥] ä½¿ç”¨ä¸»é¡µé¢åˆ©æ¯è®¡ç®—é€»è¾‘");
            
            // ä½¿ç”¨ä¸ä¸»é¡µé¢å®Œå…¨ä¸€è‡´çš„åˆ©æ¯è®¡ç®—é€»è¾‘
            Object.entries(BANK_CONFIG).forEach(([type, config]) => {
                const amount = parseInt(localStorage.getItem(config.key) || '0');
                if (amount > 0) {
                    console.log(`[æ¨¡æ‹Ÿæ¬¡æ—¥] è®¡ç®— ${config.name} åˆ©æ¯ï¼Œé‡‘é¢: ${amount}`);
                    
                    // è®¡ç®—å®é™…åˆ©ç‡ï¼ˆè€ƒè™‘æ³¢åŠ¨ï¼‰
                    let actualRate = config.rate;
                    let fluctuationType = 'none';
                    
                    if (config.hasFluctuation) {
                        // ä½¿ç”¨ä¸ä¸»é¡µé¢å®Œå…¨ä¸€è‡´çš„æ³¢åŠ¨ç®—æ³•
                        const random = Math.random();
                        
                        if (random < RISK_CONFIG.lossProbability) {
                            // 38%æ¦‚ç‡äºæŸï¼š-18%åˆ°0%
                            fluctuationType = 'loss';
                            actualRate = RISK_CONFIG.minLoss * Math.random(); // å‡åŒ€åˆ†å¸ƒåœ¨æœ€å°äºæŸåˆ°0ä¹‹é—´
                            console.log(`[æ¨¡æ‹Ÿæ¬¡æ—¥] ${config.name} äºæŸæ³¢åŠ¨ï¼Œå®é™…åˆ©ç‡: ${(actualRate * 100).toFixed(2)}%`);
                        } else if (random < RISK_CONFIG.lossProbability + RISK_CONFIG.profitProbability) {
                            // 57%æ¦‚ç‡ç›ˆåˆ©ï¼š0%åˆ°25%
                            fluctuationType = 'profit';
                            actualRate = RISK_CONFIG.maxProfit * Math.random(); // å‡åŒ€åˆ†å¸ƒåœ¨0åˆ°æœ€å¤§ç›ˆåˆ©ä¹‹é—´
                            console.log(`[æ¨¡æ‹Ÿæ¬¡æ—¥] ${config.name} ç›ˆåˆ©æ³¢åŠ¨ï¼Œå®é™…åˆ©ç‡: ${(actualRate * 100).toFixed(2)}%`);
                        } else {
                            // 5%æ¦‚ç‡é›¶æ”¶ç›Š
                            fluctuationType = 'zero';
                            actualRate = 0;
                            console.log(`[æ¨¡æ‹Ÿæ¬¡æ—¥] ${config.name} é›¶æ”¶ç›Š`);
                        }
                    }
                    
                    const interest = Math.floor(amount * actualRate);
                    
                    if (interest !== 0) {
                        // æ·»åŠ åˆ©æ¯åˆ°è´¦æˆ·ï¼ˆåªæœ‰éé›¶æ”¶ç›Šæ‰è®°å½•ï¼‰
                        localStorage.setItem(config.key, (amount + interest).toString());
                        
                        // ä¿å­˜æ˜¨æ—¥æ”¶ç›Šå’Œå®é™…åˆ©ç‡ç”¨äºæ˜¾ç¤º
                        localStorage.setItem(`yesterdayEarnings_${type}`, interest.toString());
                        localStorage.setItem(`yesterdayRate_${type}`, actualRate.toString());
                        
                        // è®°å½•åˆ©æ¯äº¤æ˜“åˆ°äº¤æ˜“å†å²
                        const transaction = {
                            type: 'interest',
                            accountType: type,
                            accountName: config.name,
                            amount: interest,
                            date: new Date().toISOString(),
                            fluctuationType: fluctuationType
                        };
                        
                        const transactions = JSON.parse(localStorage.getItem('bankTransactions') || '[]');
                        transactions.push(transaction);
                        localStorage.setItem('bankTransactions', JSON.stringify(transactions));
                        
                        console.log(`[æ¨¡æ‹Ÿæ¬¡æ—¥] ${config.name} åˆ©æ¯å·²æ›´æ–°ï¼Œæ–°ä½™é¢: ${amount + interest}`);
                    } else if (config.hasFluctuation && fluctuationType === 'zero') {
                        // é›¶æ”¶ç›Šæ—¶åªè®°å½•æ˜¾ç¤ºä¿¡æ¯ï¼Œä¸æ”¹å˜è´¦æˆ·ä½™é¢
                        localStorage.setItem(`yesterdayEarnings_${type}`, '0');
                        localStorage.setItem(`yesterdayRate_${type}`, '0');
                        console.log(`[æ¨¡æ‹Ÿæ¬¡æ—¥] ${config.name} é›¶æ”¶ç›Šï¼Œä»…è®°å½•æ˜¾ç¤ºä¿¡æ¯`);
                    }
                } else {
                    console.log(`[æ¨¡æ‹Ÿæ¬¡æ—¥] ${config.name} ä½™é¢ä¸º0ï¼Œè·³è¿‡è®¡ç®—`);
                }
            });
            
            console.log("[æ¨¡æ‹Ÿæ¬¡æ—¥] ä¸»é¡µé¢åˆ©æ¯è®¡ç®—é€»è¾‘æ‰§è¡Œå®Œæˆ");
        }
        
        // æ˜¾ç¤ºè¶…çº§å¿«è¿›ç»“æœ
        function showSimulateNextDayResult(newAmount, cost) {
            const modal = document.getElementById('simulateNextDayModal');
            const content = document.getElementById('simulateNextDayContent');
            const confirmBtn = document.getElementById('confirmSimulateBtn');
            
            if (!modal || !content || !confirmBtn) {
                console.error("[é”™è¯¯] æœªæ‰¾åˆ°è¶…çº§å¿«è¿›æ¨¡æ€æ¡†å…ƒç´ ï¼");
                return;
            }
            
            content.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 48px; margin-bottom: 15px;">âœ…</div>
                    <h3 style="color: #06d6a0; margin-bottom: 15px;">è¶…çº§å¿«è¿›æˆåŠŸ</h3>
                    <p style="margin-bottom: 10px;">å·²æˆåŠŸæ¨¡æ‹Ÿæ¬¡æ—¥åˆ©æ¯è®¡ç®—ï¼</p>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <p style="margin: 5px 0;"><strong>æ¶ˆè€—ï¼š</strong>${cost.amount}å¼ ${cost.name}</p>
                        <p style="margin: 5px 0;"><strong>å½“å‰å‰©ä½™ï¼š</strong>${newAmount}å¼ </p>
                    </div>
                    <p style="color: #666; font-size: 14px;">è¯·æŸ¥çœ‹å„è´¦æˆ·çš„æ˜¨æ—¥æ”¶ç›Šå˜åŒ–ã€‚</p>
                    <p style="color: #666; font-size: 14px;">æ­¤åŠŸèƒ½ä½¿ç”¨ä¸ä¸»é¡µé¢å®Œå…¨ä¸€è‡´çš„åˆ©æ¯è®¡ç®—é€»è¾‘ï¼Œç¡®ä¿æ¨¡æ‹Ÿç»“æœä¸çœŸæ­£æ¬¡æ—¥ä¸€è‡´ã€‚</p>
                </div>
            `;
            
            confirmBtn.style.display = 'inline-block';
            confirmBtn.textContent = 'å…³é—­';
            confirmBtn.onclick = function() {
                closeSimulateNextDayModal();
            };
            
            console.log("[è¶…çº§å¿«è¿›] æˆåŠŸæ¶ˆæ¯æ¨¡æ€æ¡†å·²æ˜¾ç¤º");
        }
        
        // å…³é—­æ¨¡æ‹Ÿæ¬¡æ—¥æ¨¡æ€æ¡†
        function closeSimulateNextDayModal() {
            const modal = document.getElementById('simulateNextDayModal');
            if (modal) {
                modal.style.display = 'none';
            }
            console.log("[æ¨¡æ‹Ÿæ¬¡æ—¥] æ¨¡æ‹Ÿæ¬¡æ—¥æ¨¡æ€æ¡†å·²å…³é—­");
        }
    </script>
</body>
</html>
